<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>SRAV – Constructeur de Séances</title>
<link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:ital,wght@0,400;0,600;0,700;0,900;1,700&family=Lato:wght@400;700&display=swap" rel="stylesheet">
<style>
:root {
  --blue:   #0055a4;
  --blue2:  #003f80;
  --yellow: #f5c800;
  --red:    #d62b2b;
  --green:  #1a8a4a;
  --orange: #e07b00;
  --slate:  #1c2b3a;
  --ink:    #2d3a47;
  --mist:   #f2f5f8;
  --line:   #dde3ea;
  --white:  #ffffff;
  --b0:     #7b5ea7;
  --b0bg:   #f3effe;
  --b1:     #d62b2b;
  --b1bg:   #fdecea;
  --b2:     #e07b00;
  --b2bg:   #fef3e2;
  --b3:     #1a8a4a;
  --b3bg:   #e6f4ec;
}
* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: 'Lato', sans-serif; background: var(--mist); color: var(--ink); min-height: 100vh; }
.bc { font-family: 'Barlow Condensed', sans-serif; }

/* ── HEADER ── */
header {
  background: var(--blue); padding: 0 20px;
  display: flex; align-items: center; justify-content: space-between;
  height: 56px; position: sticky; top: 0; z-index: 90;
  box-shadow: 0 2px 12px rgba(0,0,0,.3);
}
.logo { display: flex; align-items: center; gap: 10px; }
.logo-dot {
  width: 32px; height: 32px; background: var(--red); border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-family: 'Barlow Condensed', sans-serif; font-weight: 900; font-size: 18px; color: white;
}
.logo-text { font-family: 'Barlow Condensed', sans-serif; font-weight: 900; font-size: 18px; color: white; text-transform: uppercase; line-height: 1.1; letter-spacing: .03em; }
.logo-text em { color: var(--yellow); font-style: normal; }
.logo-badge { font-size: 9px; font-weight: 700; background: var(--yellow); color: var(--slate); padding: 2px 6px; border-radius: 3px; letter-spacing: .06em; margin-left: 6px; }

/* ── STEPPER ── */
.stepper { display: flex; align-items: center; background: rgba(255,255,255,.07); border-radius: 6px; overflow: hidden; }
.step-btn { padding: 6px 14px; font-family: 'Barlow Condensed', sans-serif; font-weight: 700; font-size: 12px; text-transform: uppercase; letter-spacing: .06em; color: rgba(255,255,255,.4); background: transparent; border: none; cursor: pointer; transition: all .2s; border-right: 1px solid rgba(255,255,255,.08); white-space: nowrap; }
.step-btn:last-child { border-right: none; }
.step-btn.done { color: rgba(255,255,255,.6); }
.step-btn.active { background: rgba(255,255,255,.12); color: var(--yellow); }
.step-btn .sn { display: inline-flex; align-items: center; justify-content: center; width: 16px; height: 16px; border-radius: 50%; font-size: 10px; margin-right: 5px; background: rgba(255,255,255,.15); color: white; }
.step-btn.active .sn { background: var(--yellow); color: var(--slate); }
.step-btn.done .sn { background: var(--green); color: white; }

/* ── SCREENS ── */
.screen { display: none; padding: 20px; max-width: 940px; margin: 0 auto; }
.screen.active { display: block; animation: fadeUp .25s ease; }
@keyframes fadeUp { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }

/* ── SECTION HEADERS ── */
.sh { font-family: 'Barlow Condensed', sans-serif; font-weight: 900; font-size: 22px; text-transform: uppercase; letter-spacing: .02em; color: var(--slate); margin-bottom: 4px; }
.sub { font-size: 13px; color: #7a8a99; margin-bottom: 20px; }

/* ── CARDS ── */
.card { background: white; border-radius: 12px; box-shadow: 0 1px 4px rgba(0,0,0,.07); overflow: hidden; margin-bottom: 16px; }
.card-head { padding: 14px 18px 10px; border-bottom: 1px solid var(--line); display: flex; align-items: center; gap: 10px; }
.card-head-icon { width: 32px; height: 32px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 14px; flex-shrink: 0; }
.card-title { font-family: 'Barlow Condensed', sans-serif; font-weight: 700; font-size: 15px; text-transform: uppercase; letter-spacing: .05em; color: var(--slate); }
.card-body { padding: 16px 18px; }

/* ── INPUTS ── */
.field { margin-bottom: 14px; }
.field:last-child { margin-bottom: 0; }
.label { display: block; font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: .08em; color: #8a9aaa; margin-bottom: 5px; }
input[type=text], input[type=number], select, textarea {
  width: 100%; padding: 9px 12px; border: 1.5px solid var(--line); border-radius: 8px;
  font-size: 14px; font-family: 'Lato', sans-serif; color: var(--slate); background: #fafbfc;
  outline: none; transition: border-color .15s; -webkit-appearance: none;
}
input:focus, select:focus, textarea:focus { border-color: var(--blue); background: white; }
.row2 { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
.row3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }

/* ── BLOC PILLS SELECTOR ── */
.bloc-selector { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 6px; }
.bloc-pill {
  padding: 7px 14px; border-radius: 8px; border: 2px solid var(--line);
  font-family: 'Barlow Condensed', sans-serif; font-weight: 700; font-size: 13px;
  cursor: pointer; transition: all .15s; background: white; color: var(--ink);
  display: flex; align-items: center; gap: 6px;
}
.bloc-pill:hover { border-color: #aac0d8; }
.bloc-pill.b0.sel { background: var(--b0bg); border-color: var(--b0); color: var(--b0); }
.bloc-pill.b1.sel { background: var(--b1bg); border-color: var(--b1); color: var(--b1); }
.bloc-pill.b2.sel { background: var(--b2bg); border-color: var(--b2); color: var(--b2); }
.bloc-pill.b3.sel { background: var(--b3bg); border-color: var(--b3); color: var(--b3); }
.bloc-dot { width: 8px; height: 8px; border-radius: 50%; }

/* ── NIVEAU PILLS ── */
.niv-selector { display: flex; gap: 6px; flex-wrap: wrap; }
.niv-pill {
  padding: 5px 12px; border-radius: 20px; border: 1.5px solid var(--line);
  font-size: 12px; font-weight: 700; cursor: pointer; transition: all .15s;
  background: var(--mist); color: var(--ink);
}
.niv-pill:hover { border-color: #aac0d8; }
.niv-pill.sel { background: var(--blue); border-color: var(--blue); color: white; }

/* ── GROUPE BUILDER ── */
.grp-row { display: grid; grid-template-columns: 110px 1fr 75px 32px; gap: 8px; align-items: center; padding: 10px 0; border-bottom: 1px solid var(--line); }
.grp-row:first-child { border-top: 1px solid var(--line); }
.grp-label { font-family: 'Barlow Condensed', sans-serif; font-weight: 700; font-size: 15px; display: flex; align-items: center; gap: 6px; }
.grp-dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }
.grp-effectif { font-size: 13px; color: #7a8a99; text-align: center; }
.btn-ghost { width: 28px; height: 28px; border-radius: 6px; border: 1px solid var(--line); background: var(--mist); color: #cc4444; font-size: 13px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all .15s; }
.btn-ghost:hover { background: #fee; border-color: #cc4444; }

/* ── BLOC TAGS ── */
.bloc-tag { display: inline-flex; align-items: center; gap: 4px; padding: 3px 8px; border-radius: 4px; font-family: 'Barlow Condensed', sans-serif; font-weight: 700; font-size: 11px; text-transform: uppercase; }
.bloc-tag.b0 { background: var(--b0bg); color: var(--b0); }
.bloc-tag.b1 { background: var(--b1bg); color: var(--b1); }
.bloc-tag.b2 { background: var(--b2bg); color: var(--b2); }
.bloc-tag.b3 { background: var(--b3bg); color: var(--b3); }

/* ── FILTERS BAR (étape 2) ── */
.filters-bar {
  background: white; border-radius: 10px; padding: 14px 18px;
  border: 1px solid var(--line); margin-bottom: 14px;
  display: flex; gap: 14px; flex-wrap: wrap; align-items: flex-start;
}
.filters-bar .filter-group { flex: 1; min-width: 200px; }
.filters-bar .filter-label { font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: .08em; color: #8a9aaa; margin-bottom: 7px; }

/* ── SITUATION CARDS ── */
.sit-grid { display: flex; flex-direction: column; gap: 8px; }
.sit-card { border: 1.5px solid var(--line); border-radius: 10px; padding: 12px 14px; cursor: pointer; transition: all .15s; position: relative; }
.sit-card:hover { border-color: #aac0d8; background: #fafcff; }
.sit-card.selected { border-color: var(--blue); background: #f0f6ff; box-shadow: 0 0 0 3px rgba(0,85,164,.1); }
.sit-card-top { display: flex; align-items: flex-start; gap: 10px; }
.sit-check { width: 20px; height: 20px; border-radius: 5px; border: 2px solid var(--line); flex-shrink: 0; margin-top: 1px; background: white; transition: all .15s; display: flex; align-items: center; justify-content: center; }
.sit-card.selected .sit-check { background: var(--blue); border-color: var(--blue); color: white; font-size: 11px; }
.sit-title { font-family: 'Barlow Condensed', sans-serif; font-weight: 700; font-size: 16px; color: var(--slate); line-height: 1.2; }
.sit-comp { font-size: 11px; color: #5a7a9a; margin-top: 2px; font-style: italic; }
.sit-badges { display: flex; gap: 5px; margin-top: 4px; flex-wrap: wrap; }
.sit-niv-badge { font-size: 9px; font-weight: 700; padding: 2px 6px; border-radius: 3px; text-transform: uppercase; letter-spacing: .04em; background: #f0f0f0; color: #555; }
.sit-niv-badge.niv-1 { background: #fff3cd; color: #7a5c00; }
.sit-niv-badge.niv-2 { background: #d1ecf1; color: #0c5460; }
.sit-niv-badge.niv-3 { background: #d4edda; color: #155724; }
.sit-spiral { font-size: 9px; background: #f3eaff; color: #7b5ea7; padding: 2px 6px; border-radius: 3px; font-weight: 700; }
.sit-detail { font-size: 12px; color: #6a7a88; margin-top: 6px; line-height: 1.5; padding-left: 30px; display: none; }
.sit-card.selected .sit-detail { display: block; }
/* ── MODAL DÉTAIL SITUATION ── */
.sit-modal-overlay {
  position:fixed; inset:0; background:rgba(0,0,0,.55);
  z-index:300; display:flex; align-items:center; justify-content:center;
  padding:16px; animation:fadeIn .15s ease;
}
@keyframes fadeIn { from{opacity:0} to{opacity:1} }
.sit-modal {
  background:white; border-radius:16px; max-width:520px; width:100%;
  max-height:90vh; overflow-y:auto;
  box-shadow:0 12px 60px rgba(0,0,0,.25);
  animation:slideUp .18s ease;
}
@keyframes slideUp { from{transform:translateY(20px);opacity:0} to{transform:translateY(0);opacity:1} }
.sit-modal-header {
  padding:20px 22px 16px;
  border-radius:16px 16px 0 0;
  display:flex; align-items:flex-start; justify-content:space-between; gap:12px;
}
.sit-modal-header h2 {
  font-family:'Barlow Condensed',sans-serif; font-weight:900;
  font-size:22px; color:white; margin:0; line-height:1.2; flex:1;
}
.sit-modal-header .sit-modal-badges { display:flex; gap:6px; margin-top:6px; flex-wrap:wrap; }
.sit-modal-header .sit-modal-badges span {
  font-size:10px; font-weight:700; padding:3px 8px; border-radius:4px;
  background:rgba(255,255,255,.25); color:white; letter-spacing:.04em;
}
.sit-modal-close {
  width:32px; height:32px; border-radius:8px;
  background:rgba(255,255,255,.2); border:none; cursor:pointer;
  color:white; font-size:18px; display:flex; align-items:center; justify-content:center;
  flex-shrink:0; transition:background .15s;
}
.sit-modal-close:hover { background:rgba(255,255,255,.35); }
.sit-modal-body { padding:20px 22px; }
.sit-modal-row {
  display:flex; gap:10px; margin-bottom:14px; align-items:flex-start;
}
.sit-modal-icon {
  width:32px; height:32px; border-radius:8px; display:flex;
  align-items:center; justify-content:center; font-size:16px;
  flex-shrink:0; margin-top:1px;
}
.sit-modal-row-content {}
.sit-modal-row-label {
  font-size:10px; font-weight:700; text-transform:uppercase;
  letter-spacing:.08em; color:#8a9aaa; margin-bottom:3px;
}
.sit-modal-row-text {
  font-size:13px; color:var(--slate); line-height:1.5;
}
.sit-modal-crit {
  background:#e6f4ec; border-left:3px solid var(--green);
  border-radius:0 8px 8px 0; padding:10px 14px;
  font-size:13px; color:#1a4a2a; font-weight:600; line-height:1.5;
  margin-bottom:14px;
}
.sit-modal-note {
  background:#fff8e6; border-left:3px solid var(--yellow);
  border-radius:0 8px 8px 0; padding:10px 14px;
  font-size:12px; color:#5a4a00; line-height:1.5; margin-bottom:14px;
}
.sit-modal-footer {
  padding:14px 22px 20px;
  display:flex; align-items:center; justify-content:space-between;
  border-top:1px solid var(--line);
}
.sit-modal-mat {
  font-size:12px; color:#5a7090;
  display:flex; align-items:center; gap:6px;
}
.sit-info-btn {
  width:22px; height:22px; border-radius:5px;
  background:rgba(0,85,164,.1); border:none; cursor:pointer;
  color:var(--blue); font-size:12px; font-weight:900;
  display:inline-flex; align-items:center; justify-content:center;
  flex-shrink:0; transition:background .15s; line-height:1;
  margin-left:4px; vertical-align:middle;
}
.sit-info-btn:hover { background:rgba(0,85,164,.2); }

/* ── GROUPE SECTION (étape 2) ── */
.grp-section { border-radius: 10px; overflow: hidden; margin-bottom: 16px; border: 1px solid var(--line); }
.grp-section-head { padding: 12px 16px; display: flex; align-items: center; gap: 10px; }
.grp-section-head .grp-num { width: 28px; height: 28px; border-radius: 7px; display: flex; align-items: center; justify-content: center; font-family: 'Barlow Condensed', sans-serif; font-weight: 900; font-size: 16px; color: white; flex-shrink: 0; }
.grp-section-head .info { flex: 1; }
.grp-section-head .gsh-title { font-family: 'Barlow Condensed', sans-serif; font-weight: 700; font-size: 16px; color: var(--slate); }
.grp-section-head .gsh-sub { font-size: 11px; color: #8a9aaa; margin-top: 1px; }
.grp-section-body { padding: 14px 16px; background: white; }

/* ── BLOC3 ALERT ── */
.bloc3-notice {
  background: #e6f4ec; border-left: 4px solid var(--green);
  padding: 12px 16px; border-radius: 0 8px 8px 0; margin-bottom: 14px;
  font-size: 12px; color: #1a3a2a;
}
.bloc3-notice strong { display: block; font-size: 13px; margin-bottom: 4px; color: var(--green); }

/* ── COMP PILLS ── */
.comp-section { margin-bottom: 14px; }
.comp-title { font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: .07em; color: #8a9aaa; margin-bottom: 8px; }
.comp-pills { display: flex; flex-wrap: wrap; gap: 6px; }
.comp-pill { padding: 5px 11px; border-radius: 20px; border: 1.5px solid var(--line); background: var(--mist); font-size: 12px; font-weight: 700; cursor: pointer; transition: all .15s; color: var(--ink); display: inline-flex; align-items: center; gap: 5px; }
.comp-pill:hover { border-color: #aac0d8; background: #f0f6ff; }
/* Sélection manuelle = bleu plein */
.comp-pill.sel-manual { border-color: var(--blue); background: var(--blue); color: white; }
/* Sélection auto (déduite des situations) = contour bleu, fond clair */
.comp-pill.sel-auto { border-color: var(--blue); background: #e8f0fb; color: var(--blue); }
/* Les deux (auto + confirmé manuellement) = bleu plein + badge ✓ */
.comp-pill.sel-both { border-color: var(--blue2); background: var(--blue); color: white; }
.comp-pill-niv { font-size: 9px; opacity: .7; }
.comp-pill-badge { font-size: 9px; padding: 1px 5px; border-radius: 3px; font-weight: 700; line-height: 1.4; }
.badge-auto { background: rgba(255,255,255,.25); color: inherit; }
.badge-auto-blue { background: rgba(0,85,164,.15); color: var(--blue); }
.badge-manual { background: rgba(255,255,255,.3); color: white; }

/* ── BILAN D'ÉVALUATION ── */
.bilan-section { margin-top: 16px; border-top: 1px solid var(--line); padding-top: 14px; }
.bilan-title { font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: .07em; color: #8a9aaa; margin-bottom: 10px; }
.bilan-grid { display: flex; flex-direction: column; gap: 6px; margin-bottom: 10px; }
.bilan-row { display: grid; grid-template-columns: 1fr auto; gap: 10px; align-items: center; padding: 6px 10px; border-radius: 6px; background: var(--mist); }
.bilan-comp-name { font-size: 12px; color: var(--slate); }
.bilan-btns { display: flex; gap: 4px; }
.bilan-btn { padding: 4px 8px; border-radius: 4px; border: 1.5px solid var(--line); background: white; font-size: 10px; font-weight: 700; cursor: pointer; transition: all .12s; color: #666; white-space: nowrap; }
.bilan-btn:hover { border-color: #aac0d8; }
.bilan-btn.sel-ok { background: #d4edda; border-color: #1a8a4a; color: #1a5c30; }
.bilan-btn.sel-prog { background: #fff3cd; border-color: #e07b00; color: #7a4a00; }
.bilan-btn.sel-non { background: #fdecea; border-color: #d62b2b; color: #8a1a1a; }
.bilan-obs textarea { height: 52px; resize: none; font-size: 12px; }

/* ── FICHE ── */
#screen-fiche { max-width: 1100px; }
.fiche-wrap { background: white; border-radius: 14px; overflow: hidden; box-shadow: 0 4px 24px rgba(0,0,0,.1); }
.fiche-banner { background: var(--blue); padding: 20px 28px; display: flex; align-items: flex-start; justify-content: space-between; gap: 20px; }
.fiche-title { font-family: 'Barlow Condensed', sans-serif; font-weight: 900; font-size: 28px; color: white; text-transform: uppercase; line-height: 1; }
.fiche-title span { color: var(--yellow); }
.fiche-subtitle { font-size: 13px; color: rgba(255,255,255,.6); margin-top: 4px; }
.fiche-chips { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 10px; }
.fiche-chip { background: rgba(255,255,255,.1); color: rgba(255,255,255,.85); font-size: 11px; font-weight: 700; padding: 4px 10px; border-radius: 4px; display: flex; align-items: center; gap: 5px; }

.fiche-infos { display: grid; border-bottom: 2px solid var(--line); }
.fi-cell { padding: 12px 18px; border-right: 1px solid var(--line); }
.fi-cell:last-child { border-right: none; }
.fi-lbl { font-size: 9px; font-weight: 700; text-transform: uppercase; letter-spacing: .08em; color: #aab; margin-bottom: 3px; }
.fi-val { font-family: 'Barlow Condensed', sans-serif; font-weight: 700; font-size: 17px; color: var(--slate); }

.fiche-cols { display: grid; border-bottom: 1px solid var(--line); }
.fiche-col { border-right: 1px solid var(--line); display: flex; flex-direction: column; }
.fiche-col:last-child { border-right: none; }
.fiche-col-head { padding: 12px 16px; border-bottom: 1px solid var(--line); display: flex; align-items: center; gap: 10px; }
.fcol-dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }
.fcol-title { font-family: 'Barlow Condensed', sans-serif; font-weight: 700; font-size: 14px; color: var(--slate); }
.fcol-sub { font-size: 10px; color: #8a9aaa; }
.fcol-comp { font-size: 10px; font-style: italic; color: #5a7090; padding: 6px 16px 10px; border-bottom: 1px solid var(--line); background: #fafbfc; }
.fiche-sit { padding: 12px 16px; border-bottom: 1px solid var(--line); }
.fiche-sit:last-child { border-bottom: none; }
.fiche-sit-num { width: 20px; height: 20px; border-radius: 5px; display: inline-flex; align-items: center; justify-content: center; font-family: 'Barlow Condensed', sans-serif; font-weight: 900; font-size: 13px; color: white; margin-right: 6px; vertical-align: middle; flex-shrink: 0; }
.fiche-sit-name { font-family: 'Barlow Condensed', sans-serif; font-weight: 700; font-size: 15px; color: var(--slate); display: inline; }
.fiche-sit-obj { font-size: 11px; color: #5a7090; margin-top: 4px; line-height: 1.45; }
.fiche-sit-crit { font-size: 10px; color: var(--green); font-weight: 700; margin-top: 4px; }
.fiche-sit-mat { font-size: 10px; color: #8a9aaa; margin-top: 3px; }

/* ── FICHE BILAN SECTION ── */
.fiche-bilan-section { padding: 18px 24px; border-top: 2px solid var(--line); background: #fafbfc; }
.fiche-bilan-title { font-family: 'Barlow Condensed', sans-serif; font-weight: 900; font-size: 16px; text-transform: uppercase; letter-spacing: .04em; color: var(--slate); margin-bottom: 14px; display: flex; align-items: center; gap: 8px; }
.fiche-bilan-cols { display: grid; gap: 16px; }
.fiche-bilan-grp { background: white; border-radius: 8px; border: 1px solid var(--line); overflow: hidden; }
.fiche-bilan-grp-head { padding: 8px 14px; display: flex; align-items: center; gap: 8px; }
.fiche-bilan-grp-name { font-family: 'Barlow Condensed', sans-serif; font-weight: 700; font-size: 15px; color: var(--slate); }
.fiche-bilan-grp-body { padding: 10px 14px; }
.fiche-bilan-comp-row { display: grid; grid-template-columns: 1fr auto; gap: 10px; align-items: center; padding: 5px 0; border-bottom: 1px solid var(--line); font-size: 11px; }
.fiche-bilan-comp-row:last-child { border-bottom: none; }
.fiche-bilan-scale { display: flex; gap: 0; }
.fbs-item { padding: 3px 8px; border: 1px solid #ddd; font-size: 10px; font-weight: 700; }
.fbs-item:first-child { border-radius: 4px 0 0 4px; }
.fbs-item:last-child { border-radius: 0 4px 4px 0; }
.fbs-ok { background: #d4edda; color: #1a5c30; border-color: #a3d4b0; }
.fbs-prog { background: #fff3cd; color: #7a4a00; border-color: #f0d080; }
.fbs-non { background: #fdecea; color: #8a1a1a; border-color: #f5c0bc; }
.fiche-bilan-obs { margin-top: 10px; }
.fiche-bilan-obs-label { font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: .07em; color: #8a9aaa; margin-bottom: 4px; }
.fiche-bilan-obs-box { border: 1px solid var(--line); border-radius: 6px; min-height: 44px; padding: 6px 10px; font-size: 11px; color: #aab; font-style: italic; }

.fiche-mat-bar { padding: 14px 20px; background: #f7f9fb; border-top: 2px solid var(--line); display: flex; align-items: flex-start; gap: 12px; flex-wrap: wrap; }
.mat-title { font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: .07em; color: #8a9aaa; flex: 0 0 100%; }
.mat-chip { background: white; border: 1px solid var(--line); font-size: 11px; font-weight: 700; color: var(--ink); padding: 4px 10px; border-radius: 4px; }

/* ── BUTTONS ── */
.btn { padding: 11px 22px; border-radius: 9px; border: none; cursor: pointer; font-family: 'Barlow Condensed', sans-serif; font-weight: 700; font-size: 15px; text-transform: uppercase; letter-spacing: .06em; transition: all .15s; display: inline-flex; align-items: center; gap: 8px; }
.btn-primary { background: var(--blue); color: white; }
.btn-primary:hover { background: var(--blue2); }
.btn-outline { background: white; color: var(--blue); border: 2px solid var(--blue); }
.btn-outline:hover { background: var(--blue); color: white; }
.btn-sm { padding: 7px 14px; font-size: 12px; }
.btn-danger { background: #fdecea; color: var(--red); border: 1px solid #f5c0bc; }
.btn-danger:hover { background: var(--red); color: white; }
.btn-print { background: var(--slate); color: white; }
.btn-print:hover { background: #263545; }

.toolbar { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; margin-bottom: 16px; justify-content: space-between; }

/* ── ALERTS ── */
.alert { padding: 10px 14px; border-radius: 8px; font-size: 12px; font-weight: 700; display: flex; align-items: flex-start; gap: 8px; margin-bottom: 14px; }
.alert-info { background: #e8f3ff; color: #1a4a8a; border-left: 3px solid var(--blue); }
.alert-warn { background: #fff8e6; color: #7a5c00; border-left: 3px solid var(--yellow); }
.alert-green { background: #e6f4ec; color: #1a4a2a; border-left: 3px solid var(--green); }

/* ── PRINT ── */
@media print {
  header, .toolbar, .no-print { display: none !important; }
  body { background: white; }
  .screen { padding: 0; max-width: 100%; }
  .fiche-wrap { box-shadow: none; border-radius: 0; }
  .fiche-cols { page-break-inside: avoid; }
  .fiche-bilan-obs-box { min-height: 60px; }
}

/* ── RESPONSIVE ── */
@media (max-width: 640px) {
  .stepper .step-label { display: none; }
  .row2, .row3 { grid-template-columns: 1fr; }
  .fiche-infos { grid-template-columns: 1fr 1fr !important; }
  .fiche-cols { grid-template-columns: 1fr !important; }
  .fiche-col { border-right: none; border-bottom: 2px solid var(--slate); }
  .grp-row { grid-template-columns: 100px 1fr 65px 30px; gap: 6px; }
  .filters-bar { flex-direction: column; }
}
.empty { text-align: center; padding: 32px 20px; color: #aab; }
.empty-icon { font-size: 36px; margin-bottom: 10px; }
.empty-text { font-family: 'Barlow Condensed', sans-serif; font-weight: 700; font-size: 16px; }

/* ── SUIVI CYCLE ── */
#screen-suivi { max-width: 1100px; }
.cycle-header { display:flex; align-items:center; justify-content:space-between; flex-wrap:wrap; gap:10px; margin-bottom:16px; }
.seance-history { display:flex; flex-direction:column; gap:10px; margin-bottom:20px; }
.seance-card { background:white; border-radius:10px; border:1px solid var(--line); overflow:hidden; }
.seance-card-head { padding:12px 18px; display:flex; align-items:center; gap:12px; cursor:pointer; user-select:none; }
.seance-card-head:hover { background:#fafcff; }
.seance-num { width:36px; height:36px; border-radius:8px; background:var(--slate); color:white; display:flex; align-items:center; justify-content:center; font-family:'Barlow Condensed',sans-serif; font-weight:900; font-size:18px; flex-shrink:0; }
.seance-meta { flex:1; }
.seance-meta-title { font-family:'Barlow Condensed',sans-serif; font-weight:700; font-size:16px; color:var(--slate); }
.seance-meta-sub { font-size:11px; color:#7a8a99; margin-top:2px; }
.seance-expand { font-size:11px; color:#8a9aaa; }
.seance-card-body { padding:14px 18px; border-top:1px solid var(--line); background:#fafbfc; display:none; }
.seance-card-body.open { display:block; }
.prog-table { width:100%; border-collapse:collapse; font-size:12px; margin-top:8px; }
.prog-table th { text-align:left; padding:6px 10px; background:var(--slate); color:white; font-family:'Barlow Condensed',sans-serif; font-size:12px; font-weight:700; }
.prog-table td { padding:6px 10px; border-bottom:1px solid var(--line); vertical-align:middle; }
.prog-table tr:last-child td { border-bottom:none; }
.prog-dot { display:inline-flex; align-items:center; gap:4px; padding:2px 7px; border-radius:3px; font-size:10px; font-weight:700; }
.prog-ok  { background:#d4edda; color:#1a5c30; }
.prog-en  { background:#fff3cd; color:#7a4a00; }
.prog-non { background:#fdecea; color:#8a1a1a; }
.prog-nd  { background:#f0f0f0; color:#888; }

/* progression summary par compétence sur tout le cycle */
.cycle-summary { background:white; border-radius:10px; border:1px solid var(--line); overflow:hidden; margin-bottom:16px; }
.cycle-summary-head { padding:14px 18px; border-bottom:1px solid var(--line); display:flex; align-items:center; gap:10px; }
.cycle-comp-row { display:grid; grid-template-columns:200px 1fr; gap:0; border-bottom:1px solid var(--line); min-height:36px; }
.cycle-comp-row:last-child { border-bottom:none; }
.cycle-comp-label { padding:8px 14px; font-size:12px; font-weight:700; color:var(--slate); border-right:1px solid var(--line); display:flex; align-items:center; }
.cycle-comp-dots { padding:8px 14px; display:flex; gap:6px; align-items:center; flex-wrap:wrap; }
.cycle-dot { width:22px; height:22px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:9px; font-weight:700; color:white; cursor:default; flex-shrink:0; }
.cycle-dot.ok  { background:#1a8a4a; }
.cycle-dot.en  { background:#e07b00; }
.cycle-dot.non { background:#d62b2b; }
.cycle-dot.nd  { background:#c0cdd8; }

/* ── QUESTIONNAIRE ÉLÈVE ── */
#screen-questionnaire { max-width: 800px; }
.qst-controls { display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-bottom:16px; }
.qst-preview { background:white; border-radius:12px; border:1px solid var(--line); overflow:hidden; }
.qst-header { background:var(--blue); padding:16px 20px; color:white; display:flex; justify-content:space-between; align-items:flex-start; }
.qst-title { font-family:'Barlow Condensed',sans-serif; font-weight:900; font-size:22px; text-transform:uppercase; }
.qst-subtitle { font-size:11px; color:rgba(255,255,255,.6); margin-top:3px; }
.qst-prenom { border:none; border-bottom:2px solid rgba(255,255,255,.4); background:transparent; color:white; font-size:14px; font-family:'Lato',sans-serif; padding:4px 0; width:200px; }
.qst-prenom::placeholder { color:rgba(255,255,255,.4); }
.qst-famille { padding:0; }
.qst-famille-head { padding:10px 18px; font-family:'Barlow Condensed',sans-serif; font-weight:700; font-size:14px; color:white; text-transform:uppercase; letter-spacing:.04em; }
.qst-item { display:grid; grid-template-columns:1fr 60px 60px 70px; padding:8px 18px; border-bottom:1px solid var(--line); font-size:13px; align-items:center; gap:8px; }
.qst-item:last-child { border-bottom:none; }
.qst-item-label { line-height:1.35; }
.qst-check-cell { text-align:center; font-size:10px; font-weight:700; color:#8a9aaa; }
.qst-box { width:24px; height:24px; border:2px solid var(--line); border-radius:4px; margin:0 auto; }
.qst-col-header { display:grid; grid-template-columns:1fr 60px 60px 70px; padding:6px 18px; background:#f7f9fb; border-bottom:2px solid var(--line); gap:8px; }
.qst-col-label { font-size:9px; font-weight:700; text-transform:uppercase; letter-spacing:.08em; color:#8a9aaa; text-align:center; }
.qst-col-label:first-child { text-align:left; }

/* ── TOAST ── */
.toast { position:fixed; bottom:24px; left:50%; transform:translateX(-50%) translateY(80px); background:var(--slate); color:white; padding:10px 20px; border-radius:8px; font-size:13px; font-weight:700; z-index:999; transition:transform .3s ease; pointer-events:none; white-space:nowrap; }
.toast.show { transform:translateX(-50%) translateY(0); }

/* ── IMPORT ZONE ── */
.import-zone { border:2px dashed var(--line); border-radius:10px; padding:24px; text-align:center; cursor:pointer; transition:all .15s; background:white; }
.import-zone:hover, .import-zone.drag { border-color:var(--blue); background:#f0f6ff; }
.import-zone p { font-size:13px; color:#8a9aaa; margin-top:6px; }

/* ── MODE IMPRESSION FICHE ── */
@media print {
  header, .toolbar, .no-print { display:none !important; }
  body { background:white; }
  .screen { padding:0; max-width:100%; }
  .fiche-wrap { box-shadow:none; border-radius:0; }
  /* Par défaut : on imprime la fiche, on masque le reste */
  #screen-1, #screen-2, #screen-suivi, #screen-questionnaire { display:none !important; }
  #screen-fiche { display:block !important; }
}

/* ── MODE IMPRESSION QUESTIONNAIRE ── */
/* On ajoute la classe .print-qst sur <body> avant d'appeler window.print() */
body.print-qst #screen-fiche    { display:none !important; }
body.print-qst #screen-suivi    { display:none !important; }
body.print-qst #screen-1        { display:none !important; }
body.print-qst #screen-2        { display:none !important; }

@media print {
  body.print-qst #screen-questionnaire {
    display:block !important;
    padding:0; max-width:100%;
  }
  body.print-qst #screen-fiche { display:none !important; }
  body.print-qst .qst-controls { display:none !important; }
  body.print-qst .qst-preview  { box-shadow:none; border-radius:0; border:none; }
}

/* ── AUTOSAVE INDICATOR ── */
.autosave-bar {
  position:fixed; bottom:0; left:0; right:0;
  background:rgba(28,43,58,.92); color:rgba(255,255,255,.7);
  font-size:11px; font-weight:700; padding:5px 16px;
  display:flex; align-items:center; justify-content:space-between;
  z-index:80; backdrop-filter:blur(4px);
  transition:opacity .3s;
}
.autosave-bar.hidden { opacity:0; pointer-events:none; }
.autosave-dot { width:7px; height:7px; border-radius:50%; background:#1a8a4a; margin-right:6px; display:inline-block; }
.autosave-dot.saving { background:var(--yellow); animation:pulse .6s infinite; }
@keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.3} }

/* ── BANNIÈRE REPRISE SESSION ── */
.session-banner {
  background:#fff8e6; border:2px solid var(--yellow);
  border-radius:10px; padding:14px 18px;
  display:flex; align-items:center; justify-content:space-between;
  gap:12px; flex-wrap:wrap; margin-bottom:16px;
}
.session-banner-text { font-size:13px; color:#5a4a00; flex:1; }
.session-banner-text strong { display:block; font-size:14px; margin-bottom:2px; }
</style>
</head>
<body>

<header>
  <div class="logo">
    <img src="data:image/png;base64,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" alt="Brandon Grotesque" style="width:48px;height:48px;border-radius:50%;object-fit:cover;flex-shrink:0;box-shadow:0 2px 8px rgba(0,0,0,.3)">
    <div class="logo-text">Savoir Rouler <em>à Vélo</em><br><span style="font-size:11px;font-weight:400;color:rgba(255,255,255,.6);letter-spacing:.12em">CONSTRUCTEUR DE SÉANCE</span></div>
    <span class="logo-badge">v14</span>
  </div>
  <div class="stepper">
    <button class="step-btn active" id="sbtn-1" onclick="goStep(1)"><span class="sn">1</span><span class="step-label">Classe</span></button>
    <button class="step-btn" id="sbtn-2" onclick="goStep(2)"><span class="sn">2</span><span class="step-label">Situations</span></button>
    <button class="step-btn" id="sbtn-3" onclick="goStep(3)"><span class="sn">3</span><span class="step-label">Fiche</span></button>
    <button class="step-btn" id="sbtn-4" onclick="goStep(4)"><span class="sn">4</span><span class="step-label">Suivi</span></button>
    <button class="step-btn" id="sbtn-5" onclick="goStep(5)"><span class="sn">5</span><span class="step-label">Élèves</span></button>
  </div>
</header>

<!-- ══════════ ÉTAPE 1 : PHOTO DE CLASSE ══════════ -->
<div class="screen active" id="screen-1">
  <div class="sh bc">Étape 1 — Photo de classe</div>
  <div class="sub">Décrivez votre classe et constituez vos groupes. En Bloc 3, la classe sort entière — pas de groupes séparés.</div>

  <div class="card">
    <div class="card-head">
      <div class="card-head-icon" style="background:#eef3fb">📋</div>
      <span class="card-title">Informations de la séquence</span>
    </div>
    <div class="card-body">
      <div class="row2">
        <div class="field">
          <label class="label">École / Établissement</label>
          <input type="text" id="f-ecole" placeholder="Ex : École Jean Moulin" />
        </div>
        <div class="field">
          <label class="label">Classe</label>
          <input type="text" id="f-classe" placeholder="Ex : CE2 – 24 élèves" />
        </div>
      </div>
      <div class="row3">
        <div class="field">
          <label class="label">Effectif total</label>
          <input type="number" id="f-effectif" value="24" min="1" max="60" />
        </div>
        <div class="field">
          <label class="label">N° de séance</label>
          <input type="number" id="f-seance-num" value="1" min="1" max="20" />
        </div>
        <div class="field">
          <label class="label">Sur (total séances)</label>
          <input type="number" id="f-seance-total" value="10" min="1" max="30" />
        </div>
      </div>
      <div class="field">
        <label class="label">Lieu</label>
        <input type="text" id="f-lieu" placeholder="Ex : Cour de récréation, espace cyclable Naudin…" />
      </div>
    </div>
  </div>

  <!-- Groupes -->
  <div class="card">
    <div class="card-head">
      <div class="card-head-icon" style="background:#eef3fb">👥</div>
      <span class="card-title">Constitution des groupes</span>
      <button class="btn btn-outline btn-sm no-print" style="margin-left:auto" onclick="addGroupe()">+ Ajouter un groupe</button>
    </div>
    <div class="card-body" style="padding-bottom:8px">
      <div class="alert alert-info">
        Commencez par l'évaluation diagnostique (séance 1) pour observer le niveau de chaque élève. En <strong>Bloc 3</strong>, tous les élèves participent ensemble — un seul groupe sera généré.
      </div>
      <div id="groupes-list"></div>
      <div id="effectif-check" style="font-size:12px;margin-top:10px;font-weight:700"></div>
    </div>
  </div>

  <div style="display:flex;justify-content:flex-end">
    <button class="btn btn-primary" onclick="goStep(2)">Choisir les situations →</button>
  </div>
</div>

<!-- ══════════ ÉTAPE 2 : SITUATIONS ══════════ -->
<div class="screen" id="screen-2">
  <div class="sh bc">Étape 2 — Situations pédagogiques</div>
  <div class="sub">Pour chaque groupe, filtrez les situations puis sélectionnez vos activités. Cochez les compétences visées et évaluez les progrès après la séance.</div>
  <div id="groupes-sit-sections"></div>
  <div style="display:flex;justify-content:space-between;flex-wrap:wrap;gap:10px">
    <button class="btn btn-outline" onclick="goStep(1)">← Modifier la classe</button>
    <button class="btn btn-primary" onclick="generateFiche()">Générer la fiche de séance →</button>
  </div>
</div>

<!-- ══════════ ÉTAPE 4 : SUIVI DU CYCLE ══════════ -->
<div class="screen" id="screen-suivi">
  <div class="cycle-header">
    <div>
      <div class="sh bc">Étape 4 — Suivi du cycle</div>
      <div class="sub" style="margin-bottom:0">Remplissez le bilan, puis sauvegardez. Rechargez votre fichier à chaque nouvelle séance.</div>
    </div>
    <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
      <button class="btn btn-outline btn-sm" id="btn-charger-cycle" onclick="document.getElementById('file-import-input').click()">
        📂 Charger un cycle existant
      </button>
      <input type="file" id="file-import-input" accept=".json" style="display:none" onchange="importCycle(this)">
      <button class="btn btn-primary btn-sm" onclick="exporterCycle()">💾 Sauvegarder &amp; exporter (.json)</button>
      <button class="btn btn-sm" onclick="preparerSeanceSuivante()" style="background:#e6f4ec;color:var(--green);border:1px solid #a8d8bc;font-weight:700">▶ Préparer la séance suivante</button>
      <button class="btn btn-sm" onclick="confirmerReinit()" style="background:#fdecea;color:var(--red);border:1px solid #f5c0bc">🗑 Réinitialiser</button>
    </div>
  </div>

  <!-- Flux de travail -->
  <div class="alert alert-info no-print" style="margin-bottom:16px">
    <div>
      <strong>Flux de travail :</strong>
      <span style="font-weight:400">
        (1) Remplissez le bilan ci-dessous après la séance →
        (2) <strong>Sauvegarder &amp; exporter</strong> pour archiver et télécharger le .json →
        (3) <strong>Préparer la séance suivante</strong> pour vider les situations et passer à la séance suivante, en conservant vos groupes.
      </span>
    </div>
  </div>

  <!-- Zone drag-drop import -->
  <div id="import-dropzone" class="import-zone" style="margin-bottom:16px;display:none"
    ondragover="event.preventDefault();this.classList.add('drag')"
    ondragleave="this.classList.remove('drag')"
    ondrop="handleDrop(event)">
    <div style="font-size:28px">📂</div>
    <div style="font-family:'Barlow Condensed',sans-serif;font-weight:700;font-size:16px;color:var(--slate);margin-top:6px">Glissez votre fichier .json ici</div>
    <p>ou cliquez sur "Charger un cycle existant" ci-dessus</p>
  </div>

  <!-- BILAN DE LA SÉANCE EN COURS -->
  <div class="card" style="margin-bottom:16px">
    <div class="card-head">
      <div class="card-head-icon" style="background:#fff3cd">📝</div>
      <span class="card-title">Bilan de la séance en cours</span>
      <span style="margin-left:auto;font-size:11px;color:#e07b00;font-weight:700">À remplir après la séance · avant de sauvegarder</span>
    </div>
    <div class="card-body" style="padding:0">
      <div id="bilan-rapide-list"></div>
    </div>
  </div>

  <!-- Synthèse progression -->
  <div id="cycle-summary-wrap"></div>

  <!-- Historique séances -->
  <div class="card">
    <div class="card-head">
      <div class="card-head-icon" style="background:#eef3fb">📅</div>
      <span class="card-title">Historique des séances sauvegardées</span>
      <span id="cycle-count" style="margin-left:auto;font-size:12px;color:#8a9aaa"></span>
    </div>
    <div class="card-body" style="padding:0">
      <div id="seance-history-list">
        <div class="empty" style="padding:24px">
          <div class="empty-icon">📭</div>
          <div class="empty-text">Aucune séance sauvegardée</div>
          <p style="font-size:12px;color:#aab;margin-top:6px">Remplissez le bilan ci-dessus et cliquez "Sauvegarder &amp; exporter"</p>
        </div>
      </div>
    </div>
  </div>

  <div style="display:flex;justify-content:space-between;flex-wrap:wrap;gap:10px">
    <button class="btn btn-outline" onclick="goStep(3)">← Retour à la fiche</button>
    <button class="btn btn-primary" onclick="goStep(5)">Questionnaire élèves →</button>
  </div>
</div>

<!-- ══════════ ÉTAPE 5 : QUESTIONNAIRE ÉLÈVE ══════════ -->
<div class="screen" id="screen-questionnaire">
  <div class="sh bc">Étape 5 — Questionnaire d'auto-évaluation</div>
  <div class="sub">Fiche élève à imprimer, filtrée sur les compétences travaillées dans ce cycle.</div>

  <div class="qst-controls no-print">
    <div style="font-size:12px;color:#7a8a99;flex:1">Les items en grisé n'ont pas encore été travaillés. Décochez-les pour les masquer à l'impression.</div>
    <label style="display:flex;align-items:center;gap:6px;font-size:13px;cursor:pointer">
      <input type="checkbox" id="qst-hide-unused" onchange="renderQuestionnaire()"> Masquer les items non travaillés
    </label>
    <button class="btn btn-print btn-sm" onclick="printQuestionnaire()">🖨 Imprimer les fiches élèves</button>
  </div>

  <div class="qst-preview" id="qst-output"></div>

  <div style="margin-top:16px;display:flex;justify-content:space-between;flex-wrap:wrap;gap:10px">
    <button class="btn btn-outline" onclick="goStep(4)">← Retour au suivi</button>
  </div>
</div>

<!-- MODAL DÉTAIL SITUATION -->
<div id="sit-modal-overlay" class="sit-modal-overlay" style="display:none" onclick="closeSitModal(event)">
  <div class="sit-modal" id="sit-modal-box">
    <div class="sit-modal-header" id="sit-modal-header">
      <div style="flex:1">
        <h2 id="sit-modal-titre"></h2>
        <div class="sit-modal-badges" id="sit-modal-badges"></div>
      </div>
      <button class="sit-modal-close" onclick="document.getElementById('sit-modal-overlay').style.display='none'">✕</button>
    </div>
    <div class="sit-modal-body" id="sit-modal-body"></div>
    <div class="sit-modal-footer" id="sit-modal-footer"></div>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<!-- MODAL CONFIRMATION RÉINITIALISATION -->
<div id="reinit-modal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:200;align-items:center;justify-content:center">
  <div style="background:white;border-radius:14px;padding:28px;max-width:400px;width:90%;box-shadow:0 8px 40px rgba(0,0,0,.2)">
    <div style="font-size:28px;text-align:center;margin-bottom:12px">⚠️</div>
    <div style="font-family:'Barlow Condensed',sans-serif;font-weight:900;font-size:20px;color:var(--slate);text-align:center;margin-bottom:8px">Réinitialiser l'outil ?</div>
    <p style="font-size:13px;color:#5a7090;text-align:center;margin-bottom:6px">Cette action supprime :</p>
    <ul style="font-size:12px;color:#5a7090;margin:0 0 16px 20px;line-height:1.8">
      <li>La session en cours (groupes, situations, bilans)</li>
      <li>L'historique du cycle en mémoire</li>
      <li>La sauvegarde automatique du navigateur</li>
    </ul>
    <p style="font-size:12px;font-weight:700;color:var(--red);text-align:center;margin-bottom:20px">⚠ Exportez d'abord votre cycle (.json) si vous souhaitez le conserver.</p>
    <div style="display:flex;gap:10px;justify-content:center">
      <button class="btn btn-outline" onclick="fermerReinit()">Annuler</button>
      <button class="btn" style="background:var(--red);color:white" onclick="reinitialiser()">Oui, tout effacer</button>
    </div>
  </div>
</div>

<!-- BANNIÈRE REPRISE SESSION -->
<div class="session-banner" id="session-banner" style="display:none;margin:12px 20px 0">
  <div class="session-banner-text">
    <strong>💾 Session précédente trouvée</strong>
    Une sauvegarde automatique existe — vous pouvez reprendre exactement là où vous en étiez.
  </div>
  <div style="display:flex;gap:8px;flex-shrink:0">
    <button class="btn btn-primary btn-sm" onclick="restaurerSession()">↩ Reprendre la session</button>
    <button class="btn btn-outline btn-sm" onclick="ignorerSession()">Ignorer</button>
  </div>
</div>

<!-- BARRE AUTOSAVE -->
<div class="autosave-bar hidden" id="autosave-bar">
  <span><span class="autosave-dot" id="autosave-dot"></span><span id="autosave-msg">Sauvegarde automatique active</span></span>
  <span style="font-size:10px;opacity:.6">Les données sont conservées si la page se recharge accidentellement</span>
</div>
<div class="screen" id="screen-fiche">
  <div class="toolbar no-print">
    <div>
      <div class="sh bc" style="font-size:18px;margin-bottom:0">Fiche de séance</div>
      <div style="font-size:12px;color:#8a9aaa">Imprimez cette fiche · Remplissez le bilan après la séance en étape 4</div>
    </div>
    <div style="display:flex;gap:8px;flex-wrap:wrap">
      <button class="btn btn-outline btn-sm" onclick="goStep(2)">← Modifier</button>
      <button class="btn btn-outline btn-sm" onclick="goStep(4)" style="border-color:var(--orange);color:var(--orange)">📝 Bilan &amp; Suivi</button>
      <button class="btn btn-print btn-sm" onclick="window.print()">🖨 Imprimer / PDF</button>
    </div>
  </div>
  <div class="fiche-wrap" id="fiche-output"></div>
</div>

<script>
/* ════════════════════════════════════════════════════
   RÉFÉRENTIEL SRAV — 4 BLOCS + NIVEAUX 1/2/3
   ════════════════════════════════════════════════════ */
const BLOCS_META = {
  b0: { label:"Bloc 0 – S'équilibrer",      shortLabel:"Bloc 0",  color:"#7b5ea7", bg:"#f3effe", icon:"🧸", contexte:"Maternelle / Draisienne" },
  b1: { label:"Bloc 1 – Savoir Pédaler",    shortLabel:"Bloc 1",  color:"#d62b2b", bg:"#fdecea", icon:"🚲", contexte:"Milieu aménagé — cour d'école" },
  b2: { label:"Bloc 2 – Savoir Circuler",   shortLabel:"Bloc 2",  color:"#e07b00", bg:"#fef3e2", icon:"🔁", contexte:"Milieu protégé — circuit balisé" },
  b3: { label:"Bloc 3 – Savoir Rouler",     shortLabel:"Bloc 3",  color:"#1a8a4a", bg:"#e6f4ec", icon:"🛣️",  contexte:"Voie publique — toute la classe", classeEntiere:true },
};

/* Compétences par bloc, chacune associée à un niveau 1/2/3
   niv = niveau où elle est principalement visée (peut être travaillée dans plusieurs blocs)
   spiral = [blocs dans lesquels elle réapparaît] */
const COMPETENCES = {
  b0: {
    comps: [
      { id:"b0-eq",  label:"Équipement (casque)", niv:1, detail:"Mettre et régler son casque seul" },
      { id:"b0-eg",  label:"Marcher à côté · monter/descendre seul", niv:1, detail:"Pousser le vélo sans le faire tomber · Monter et descendre sans aide" },
      { id:"b0-mv",  label:"S'équilibrer en mouvement", niv:1, detail:"Pousser, glisser, lever les pieds en sustentation" },
      { id:"b0-ar",  label:"S'arrêter au signal", niv:1, detail:"Poser les deux pieds au sol sur signal — arrêt complet en 2 secondes" },
      { id:"b0-tr",  label:"Trajectoire libre et franchissement", niv:1, detail:"Contourner des obstacles · Traverser une zone délimitée sans poser les pieds" },
      { id:"b0-vl",  label:"Vitesse lente & freinage précis", niv:2, detail:"Rouler lentement sans poser le pied · S'arrêter dans une zone ciblée" },
      { id:"b0-tp",  label:"Trajectoire précise (couloir, cible)", niv:2, detail:"Traverser un couloir qui rétrécit · Atteindre une cible d'arrêt" },
      { id:"b0-fr",  label:"Franchissement actif (bosse)", niv:2, detail:"Franchir un obstacle bas avec prise d'élan et genoux souples" },
      { id:"b0-di",  label:"Dissociation tête/tronc", niv:2, detail:"Tourner la tête en arrière sans dévier de trajectoire · Identifier un signal" },
      { id:"b0-co",  label:"Gestion collective & relais", niv:2, detail:"Rouler à plusieurs · Passer un relais sans collision · Respecter les autres" },
    ]
  },
  b1: {
    comps: [
      { id:"b1-eq",  label:"Équipement & vérification du vélo",   niv:1, spiral:["b2","b3"], detail:"Mettre le casque, nommer les éléments, vérifier freins et pneus" },
      { id:"b1-fd",  label:"Monter/descendre · démarrer",          niv:1, detail:"Monter et descendre à l'arrêt · Démarrer pied sur pédale haute" },
      { id:"b1-ld",  label:"Ligne droite & slalom simple",         niv:1, detail:"Conduire en ligne droite · Slalom simple sans poser le pied" },
      { id:"b1-fr",  label:"Freiner dans une zone délimitée",      niv:1, spiral:["b2","b3"], detail:"Ralentir, freiner et s'arrêter dans une zone délimitée" },
      { id:"b1-pan", label:"Panneaux signalétiques (niveau 1)",    niv:1, spiral:["b2","b3"], detail:"Stop, sens interdit, vélos interdits, piste cyclable, cédez le passage, sens unique" },
      { id:"b1-ap",  label:"Relâcher un appui (main ou pied)",     niv:2, detail:"Rouler en enlevant une main ou un pied de l'appui" },
      { id:"b1-ci",  label:"Couloir étroit (30 cm) + prise d'info",niv:2, detail:"Rouler dans un couloir 30 cm / 10 m · Prendre des informations en roulant" },
      { id:"b1-vi",  label:"Virage à 90° & franchissement",        niv:2, detail:"Effectuer un virage à 90° · Franchir un petit obstacle" },
      { id:"b1-vt",  label:"Changement de vitesses",               niv:3, detail:"Changer de vitesse en roulant selon le relief ou un signal" },
    ]
  },
  b2: {
    comps: [
      { id:"b2-eq",  label:"Sécurité vélo (éclairage, catadioptres, sonnette)", niv:2, spiral:["b3"], detail:"Identifier les éléments de sécurité · Vérifier le bon fonctionnement" },
      { id:"b2-pan", label:"Panneaux signalétiques (niveau 2)",    niv:2, spiral:["b3"], detail:"Feu tricolore, sens giratoire, priorité à droite, endroit fréquenté par des enfants" },
      { id:"b2-es",  label:"Identifier les espaces cyclables",     niv:2, spiral:["b3"], detail:"Reconnaître piste cyclable, bande cyclable, chaussée" },
      { id:"b2-cr",  label:"Code de la route en milieu protégé",   niv:2, spiral:["b3"], detail:"Rouler en respectant le code de la route sur circuit balisé" },
      { id:"b2-au",  label:"Tenir compte des autres usagers",      niv:2, spiral:["b3"], detail:"Adapter son déplacement aux autres élèves et piétons" },
      { id:"b2-co",  label:"Communiquer avec les autres cyclistes",niv:3, spiral:["b3"], detail:"Faire connaître sa direction · Identifier les changements de direction des autres" },
      { id:"b2-gi",  label:"Giratoire en milieu protégé",          niv:3, detail:"S'insérer et circuler sur un rond-point tracé au sol" },
    ]
  },
  b3: {
    comps: [
      { id:"b3-eq",  label:"Vérification complète du vélo",        niv:3, detail:"Potence, serrage des roues, selle, freins — vérification avant la sortie" },
      { id:"b3-pan", label:"Panneaux signalétiques (niveau 3)",    niv:3, detail:"Tous les panneaux : stop, giratoire, zone piétonne, priorité à droite" },
      { id:"b3-es",  label:"Emprunter les espaces cyclables réels",niv:3, detail:"Piste cyclable, bande cyclable · Ne pas rouler sur le trottoir" },
      { id:"b3-cr",  label:"Code de la route en situation réelle", niv:3, detail:"Circuler en respectant le code de la route sur voie publique" },
      { id:"b3-us",  label:"Tenir compte des usagers réels",       niv:3, detail:"Voitures, piétons, autres cyclistes — s'adapter en temps réel" },
      { id:"b3-dr",  label:"Rouler à droite & en file",            niv:3, detail:"Rouler à droite · Rouler en file indienne sur la voie publique" },
      { id:"b3-gi",  label:"Giratoires & intersections réels",     niv:3, detail:"Prendre sa place sur la chaussée aux giratoires et intersections" },
    ]
  }
};

/* ════════════════════════════════════════════════════
   BASE DE DONNÉES — SITUATIONS PÉDAGOGIQUES
   ════════════════════════════════════════════════════ */
const SITUATIONS = [
  // ── BLOC 0 — Niveau 1 : Apprivoiser l'engin ────────────────
  { id:"s00a", bloc:"b0", niv:1, comps:["b0-eq","b0-eg"],
    titre:"Marcher à côté du vélo",
    obj:"Apprivoiser l'engin avant d'y monter.",
    desc:"L'élève pousse sa draisienne à la main en marchant à côté, guidon dans la paume, sans la laisser tomber. Aller-retour sur 15 m avec virages doux.",
    crit:"Vélo maintenu vertical sur tout le parcours, sans aide de l'adulte.",
    mat:"Draisiennes, plots pour les virages", duree:"8 min",
    note:"Prérequis absolu — permet de vérifier que l'élève a apprivoisé l'engin avant de monter dessus." },

  { id:"s00b", bloc:"b0", niv:1, comps:["b0-eg"],
    titre:"Monter et descendre seul",
    obj:"Acquérir l'autonomie complète sur la draisienne.",
    desc:"L'élève monte seul du côté gauche, se met en selle, puis descend seul sans aide. 5 répétitions. L'enseignant démontre une fois.",
    crit:"Monte et descend sans soutien de l'adulte, vélo stable.",
    mat:"Draisiennes réglées (selle : pieds à plat au sol)", duree:"8 min",
    note:"La hauteur de selle est déterminante : pieds à plat au sol obligatoire en Bloc 0." },

  { id:"s00c", bloc:"b0", niv:1, comps:["b0-mv","b0-eg"],
    titre:"Le déménageur",
    obj:"S'équilibrer en gérant une tâche duale (conduire + surveiller un objet).",
    desc:"L'élève transporte un objet léger posé devant lui (ou dans un panier) en roulant de la zone départ à la zone arrivée distantes de 10 m, sans le faire tomber.",
    crit:"L'objet arrive à destination sans être tombé, sans aide.",
    mat:"Draisiennes, plots ou sacs de sable, 2 cerceaux (zones)", duree:"12 min",
    note:"La tâche duale oblige l'élève à lever les yeux — geste fondamental pour la suite. Précurseur de la prise d'information en roulant." },

  { id:"s00d", bloc:"b0", niv:1, comps:["b0-mv","b0-ar"],
    titre:"Minuit dans la bergerie",
    obj:"Rouler librement et s'immobiliser au signal.",
    desc:"Les élèves roulent librement dans l'espace. Quand le loup crie \"Minuit !\", chacun pose les deux pieds au sol et s'immobilise. Le loup vérifie qui bouge encore.",
    crit:"Arrêt complet avec deux pieds au sol dans les 2 secondes suivant le signal.",
    mat:"Draisiennes, espace 15×15 m", duree:"10 min",
    note:"Précurseur direct de 1-2-3 Soleil (B1). La différence : ici on pose les pieds, en B1 on freine sans poser le pied." },

  { id:"s00e", bloc:"b0", niv:1, comps:["b0-mv","b0-tr"],
    titre:"Slalom libre",
    obj:"Orienter sa trajectoire pour contourner des obstacles.",
    desc:"6 plots espacés de 1,5 m sur 9 m. Passage libre sans sens imposé d'abord, puis slalom imposé. L'élève pousse avec les pieds en cherchant à ne pas renverser les plots.",
    crit:"Traverser le slalom complet sans renverser de plot, sans aide.",
    mat:"6 plots, espace 15 m", duree:"10 min",
    note:"Précurseur de L'entonnoir et du Slalom simple (B1). Varier l'espacement selon les progrès." },

  { id:"s00f", bloc:"b0", niv:1, comps:["b0-mv","b0-tr"],
    titre:"La rivière",
    obj:"Traverser une zone délimitée en levant les pieds.",
    desc:"Deux lignes parallèles au sol (ruban ou craie) distantes de 30 cm à 1 m représentent une rivière. L'élève prend de l'élan et passe la rivière sans poser les pieds dans la zone.",
    crit:"Traverser la rivière sans toucher le sol dans la zone délimitée.",
    mat:"Ruban adhésif ou craie, espace 20 m", duree:"10 min",
    note:"Commencer à 30 cm, élargir progressivement jusqu'à 1 m. Précurseur du Bac à gravier (B1)." },

  // ── BLOC 0 — Niveau 2 : Contrôle et anticipation ────────────
  { id:"s00g", bloc:"b0", niv:2, comps:["b0-vl","b0-mv"],
    titre:"L'escargot draisienne",
    obj:"Maîtriser l'équilibre à très faible vitesse sans poser les pieds.",
    desc:"Couloir de 10 m × 1 m. Rouler le plus lentement possible sans poser les pieds ni sortir du couloir. Le dernier arrivé gagne.",
    crit:"Arriver dernier en ayant maintenu les pieds levés sur au moins 5 m.",
    mat:"Ruban ou plots, espace plat 12 m", duree:"10 min",
    note:"Version draisienne de L'escargot (B1-N1) — critère identique, engin différent. Évaluation diagnostique directe de la préparation au Bloc 1." },

  { id:"s00h", bloc:"b0", niv:2, comps:["b0-vl","b0-ar"],
    titre:"La cible",
    obj:"Doser la décélération pour s'arrêter à un endroit précis.",
    desc:"Un cerceau (cible) est posé à 5 m du départ. L'élève prend de l'élan puis pose les deux pieds pour s'arrêter le plus près possible du centre. 5 essais.",
    crit:"S'arrêter dans la cible ou à moins de 30 cm — réussite sur 3 essais sur 5.",
    mat:"1 cerceau ou craie, espace 10 m", duree:"10 min",
    note:"Allonger la distance départ/cible pour augmenter la difficulté. Précurseur direct du Pose-pied (B1-N1)." },

  { id:"s00i", bloc:"b0", niv:2, comps:["b0-tp","b0-mv"],
    titre:"Le couloir qui rétrécit",
    obj:"Maîtriser une trajectoire précise dans un espace contraignant.",
    desc:"Couloir progressivement plus étroit : 80 cm à l'entrée, 30 cm à la sortie, sur 8 m. Traverser sans toucher les bords ni poser les pieds.",
    crit:"Sortir du couloir sans avoir touché les limites ni posé les pieds sur les 3 derniers mètres.",
    mat:"Plots ou ruban, 10 m d'espace", duree:"10 min",
    note:"Version draisienne de L'entonnoir (B1-N1). Critère limité aux 3 derniers mètres — exiger l'intégralité serait irréaliste à ce stade." },

  { id:"s00j", bloc:"b0", niv:2, comps:["b0-fr","b0-mv"],
    titre:"La bosse",
    obj:"Franchir un obstacle bas avec prise d'élan et absorption des chocs.",
    desc:"Un plan incliné doux (planche 5 cm, 1 m de long) à franchir en roulant. L'élève prend de l'élan, franchit la bosse sans poser les pieds, genoux souples.",
    crit:"Franchir sans poser le pied, maintenir l'équilibre à la réception.",
    mat:"Planche 5 cm, espace 15 m", duree:"10 min",
    note:"Dire aux élèves : \"tu es un ressort\". Précurseur du Passage d'obstacle et du Bac à gravier (B1-N2)." },

  { id:"s00k", bloc:"b0", niv:2, comps:["b0-di","b0-mv"],
    titre:"Regard en arrière",
    obj:"Tourner la tête pour identifier un signal sans dévier de trajectoire.",
    desc:"Couloir droit de 12 m. L'enseignant se place en bout de couloir avec des cartons de couleur (rouge, bleu, jaune). L'élève roule droit, tourne la tête à mi-parcours et annonce la couleur vue.",
    crit:"Couleur correctement identifiée sans déviation de trajectoire visible.",
    mat:"Couloir 12 m, 3 cartons de couleur", duree:"10 min",
    note:"Précurseur direct de La prise d'information (B2-N1). Compétence la plus discriminante du passage B1→B2 — la travailler dès la draisienne a une vraie valeur." },

  { id:"s00l", bloc:"b0", niv:2, comps:["b0-co","b0-mv"],
    titre:"Le relais en équipe",
    obj:"Rouler à plusieurs en gérant l'espace partagé et la sécurité collective.",
    desc:"2 équipes de 4-5 élèves. Parcours aller-retour de 10 m avec un plot à contourner. Chaque élève roule jusqu'au plot, fait demi-tour, revient et touche la main du suivant dans la zone de relais.",
    crit:"Passage de relais dans la zone, sans collision, tous les membres passent.",
    mat:"2 plots, zone de relais (cerceau), espace 15 m", duree:"12 min",
    note:"Précurseur de Rouler à plusieurs (B2-N3). Introduit la notion de sécurité collective : je regarde les autres, pas seulement devant moi." },

  // ── BLOC 1 — Niveau 1 : L'Équilibre Fondamental ─────────────
  // Source : Guide pédagogique SRAV — 21 situations officielles

  { id:"s01", bloc:"b1", niv:1, comps:["b1-fd","b1-fr"],
    titre:"L'escargot",
    obj:"Maîtriser l'équilibre à très faible vitesse sans poser le pied.",
    desc:"Couloir de 10 m × 1 m. Course de lenteur : rouler le plus lentement possible d'un point A à un point B. Le dernier arrivé gagne.",
    crit:"Le dernier arrivé sans avoir posé le pied au sol a gagné.",
    mat:"Couloir 10 m × 1 m (plots ou ruban)", duree:"10 min",
    note:"Adaptable à la draisienne (B0-N2 : L'escargot draisienne)." },

  { id:"s02", bloc:"b1", niv:1, comps:["b1-fd","b1-fr"],
    titre:"1-2-3 Soleil",
    obj:"Rouler et s'immobiliser instantanément au signal sans poser le pied.",
    desc:"Espace libre. Un meneur de jeu donne les signaux. Les élèves roulent et s'immobilisent instantanément quand le meneur se retourne et crie « Soleil ! ».",
    crit:"Arrêt immédiat et maintien de l'équilibre (2-3 sec) sans poser le pied.",
    mat:"Espace libre, meneur de jeu (enseignant ou élève)", duree:"10 min",
    note:"Situation incontournable : installe le réflexe d'arrêt d'urgence. Précurseur direct de la sécurité en circulation." },

  { id:"s03", bloc:"b1", niv:3, comps:["b1-ap"],
    titre:"Rouler en enlevant un appui",
    obj:"Maintenir une trajectoire rectiligne en levant une main ou un pied.",
    desc:"Piste plane, dégagée et sécurisée. Rouler en levant une main (lâcher guidon) ou un pied (pédale).",
    crit:"Maintenir une trajectoire rectiligne sur 10 m malgré le déséquilibre.",
    mat:"Piste plane et dégagée, espace 15 m", duree:"10 min",
    note:"Adaptable à la draisienne : lever un pied uniquement." },

  // ── BLOC 1 — Niveau 2 : La Précision de Trajectoire ─────────
  { id:"s04", bloc:"b1", niv:2, comps:["b1-ld"],
    titre:"L'entonnoir",
    obj:"S'engager dans un couloir qui se rétrécit sans toucher les bords.",
    desc:"Couloir se rétrécissant de 40 cm (entrée) à 10 cm (sortie) sur 5 m de long, matérialisé par des lattes ou plots. S'engager et traverser sans toucher les bords.",
    crit:"Sortie réussie sans renverser de plot ni poser le pied.",
    mat:"Lattes ou plots, couloir de 5 m (40 cm → 10 cm)", duree:"12 min",
    note:"Vérifier la pédale intérieure relevée dans la phase de rétrécissement." },

  { id:"s05", bloc:"b1", niv:2, comps:["b1-ld"],
    titre:"Suivre une bande étroite",
    obj:"Rouler sur une bande étroite sans en sortir sur toute sa longueur.",
    desc:"Planche au sol ou marquage type ligne blanche de 15 cm de large. Rouler sur la bande sur toute sa longueur.",
    crit:"La roue avant ne doit jamais quitter la bande.",
    mat:"Planche au sol ou marquage type ligne blanche (15 cm de large)", duree:"10 min" },

  { id:"s06", bloc:"b1", niv:2, comps:["b1-ld"],
    titre:"Suivre la corde",
    obj:"Suivre précisément un tracé courbe posé au sol.",
    desc:"Corde posée au sol formant des courbes douces. La roue avant doit suivre précisément le tracé de la corde.",
    crit:"Ne pas s'écarter de plus de 10 cm de la corde.",
    mat:"Corde ou ruban formant des courbes douces, espace 15 m", duree:"10 min" },

  // ── BLOC 1 — Niveau 2 : Maniabilité et Obstacles ────────────
  { id:"s07", bloc:"b1", niv:2, comps:["b1-ld"],
    titre:"Le slalom",
    obj:"Enchaîner les virages en rythme entre des plots espacés.",
    desc:"Plots espacés de 1,50 m à 2 m sur une ligne de 20 m. Enchaîner les virages en rythme.",
    crit:"Aucun plot touché, pédale intérieure relevée dans les virages.",
    mat:"Plots espacés de 1,5 m à 2 m, ligne de 20 m", duree:"12 min" },

  { id:"s08", bloc:"b1", niv:3, comps:["b1-vi"],
    titre:"Passage d'obstacle",
    obj:"Franchir un obstacle bas en levant la roue avant ou en délestant le vélo.",
    desc:"Petites lattes ou obstacles bas posés au sol. Franchir en levant la roue avant ou en délestant le vélo.",
    crit:"Franchissement souple, pas de perte d'équilibre.",
    mat:"Petites lattes ou obstacles bas (3-5 cm), espace dégagé", duree:"10 min" },

  { id:"s09", bloc:"b1", niv:3, comps:["b1-vi"],
    titre:"Bac à gravier",
    obj:"Traverser une zone instable sans s'arrêter ni dévier.",
    desc:"Zone instable (gravier, sable ou tapis mou) de quelques mètres. Traverser la zone sans s'arrêter et sans dévier.",
    crit:"Traversée complète sans poser le pied, vitesse constante.",
    mat:"Zone de gravier, sable ou tapis mou, quelques mètres", duree:"10 min" },

  // ── BLOC 1 — Niveau 2 : Propulsion et Démarrage ─────────────
  { id:"s10", bloc:"b1", niv:1, comps:["b1-fd"],
    titre:"Le pousser-pédaler",
    obj:"Prendre de la vitesse en mode trottinette puis monter en selle.",
    desc:"Mode trottinette : un pied sur pédale basse, un au sol. Pousser au sol pour prendre de la vitesse puis monter sur la selle.",
    crit:"Gain de vitesse efficace et insertion fluide du deuxième pied sur la pédale.",
    mat:"Vélos, espace plat dégagé 20 m", duree:"10 min",
    note:"Utile pour les élèves qui ont du mal à démarrer — étape intermédiaire avant le démarrage arrêté." },

  { id:"s11", bloc:"b1", niv:1, comps:["b1-fd"],
    titre:"Démarrage arrêté",
    obj:"Se propulser efficacement depuis l'arrêt avec la pédale d'appel en haut.",
    desc:"Ligne de départ. Placer la pédale d'appel en haut (position 14h) et se propulser en avant.",
    crit:"Démarrage droit, sans zigzag, propulsion immédiate et franche.",
    mat:"Ligne de départ, espace 20 m", duree:"10 min",
    note:"Vérifier la position de la pédale d'appel : ni trop haute (12h) ni trop basse (15h) — 14h est l'idéal." },

  { id:"s12", bloc:"b1", niv:3, comps:["b1-vt"],
    titre:"Changement de vitesses",
    obj:"Adapter le braquet avant la difficulté pour maintenir un pédalage fluide.",
    desc:"Parcours plat suivi d'une montée ou terrain varié. Changer de vitesse avant la difficulté (anticipation).",
    crit:"La chaîne ne craque pas, fluidité du pédalage conservée.",
    mat:"Vélos avec dérailleur, parcours avec relief ou montée simulée", duree:"15 min" },

  // ── BLOC 1 — Niveau 3 : Freinage et Maîtrise ────────────────
  { id:"s13", bloc:"b1", niv:3, comps:["b1-fr"],
    titre:"Jeu de la latte",
    obj:"Arriver avec de la vitesse et freiner pour s'arrêter juste devant la latte.",
    desc:"Une latte posée en équilibre sur deux plots (hauteur faible). Arriver avec de la vitesse et freiner pour s'arrêter juste devant.",
    crit:"S'arrêter à moins de 10 cm sans faire tomber la latte.",
    mat:"1 latte souple, 2 plots (hauteur faible), espace 20 m", duree:"10 min" },

  { id:"s14", bloc:"b1", niv:1, comps:["b1-fr"],
    titre:"Le pose pied",
    obj:"S'arrêter et choisir volontairement quel pied poser.",
    desc:"Zones d'arrêt matérialisées par des cerceaux ou craie. S'arrêter et choisir volontairement quel pied poser (droit ou gauche) selon la consigne.",
    crit:"Vélo stable, seul le pied choisi touche le sol.",
    mat:"Cerceaux ou craie (zones d'arrêt), espace 10 m", duree:"10 min" },

  { id:"s15", bloc:"b1", niv:3, comps:["b1-vi"],
    titre:"Virage à 90°",
    obj:"Négocier un virage serré en gérant la vitesse et le regard.",
    desc:"Couloir formant un angle droit serré (type coin de rue). Négocier le virage en gérant la vitesse et le regard.",
    crit:"Sortie de virage sans écart, pédale intérieure relevée.",
    mat:"Plots formant un angle droit, espace 10×10 m", duree:"12 min" },

  // ── BLOC 2 — Communication et Sécurité ──────────────────────
  { id:"s16", bloc:"b2", niv:2, comps:["b2-au","b2-co"],
    titre:"La prise d'information",
    obj:"Regarder derrière soi sans dévier de trajectoire (dissociation tête/tronc).",
    desc:"Enseignant placé derrière l'élève avec des cartons de couleur ou chiffres. L'élève roule droit, regarde par-dessus son épaule et annonce ce qu'il voit.",
    crit:"Pas d'écart de trajectoire lors du regard arrière (dissociation tête/tronc).",
    mat:"Couloir 15 m, cartons de couleur ou chiffres", duree:"12 min",
    note:"Compétence discriminante du passage B1→B2. La travailler en B0-N2 (Regard en arrière) en prépare le succès." },

  { id:"s17", bloc:"b2", niv:2, comps:["b2-co","b2-au"],
    titre:"Lâcher le guidon / Signaler",
    obj:"Tendre le bras clairement pour signaler un changement de direction.",
    desc:"Parcours avec changements de direction matérialisés. Tendre le bras clairement du côté du tournant avant de tourner.",
    crit:"Bras tendu 3 secondes, trajectoire stable, mains replacées avant le virage.",
    mat:"Parcours balisé avec virages, plots, espace 20 m", duree:"12 min" },

  // ── BLOC 2 — Dynamique de Groupe ────────────────────────────
  { id:"s18", bloc:"b2", niv:3, comps:["b2-au"],
    titre:"Rouler à plusieurs / en groupe",
    obj:"Rouler en file indienne en conservant les distances de sécurité.",
    desc:"File indienne sur parcours en boucle. Rouler en conservant les distances de sécurité (1 à 2 vélos entre chaque élève).",
    crit:"Pas d'effet accordéon, distances respectées, freinage anticipé.",
    mat:"Parcours en boucle, espace 30 m minimum", duree:"15 min" },

  { id:"s19", bloc:"b2", niv:3, comps:["b2-cr","b2-au"],
    titre:"Arrêt en groupe (Stop)",
    obj:"Coordonner l'arrêt collectif au panneau STOP puis repartir un par un.",
    desc:"Panneau STOP matérialisé au sol. Le premier s'arrête au trait, les autres s'empilent derrière sans dépasser.",
    crit:"Pied à terre absolu pour tous (3 sec), redémarrage ordonné un par un.",
    mat:"Panneau STOP au sol (ruban ou carton), espace 20 m", duree:"12 min" },

  // ── BLOC 2 — Intersections Complexes ────────────────────────
  { id:"s20", bloc:"b2", niv:3, comps:["b2-cr","b2-es"],
    titre:"La grande circulation",
    obj:"S'insérer dans un carrefour simulé en respectant les priorités.",
    desc:"Carrefour simulé avec priorités (feux, panneaux, marquage au sol). S'insérer, respecter les priorités à droite ou panneaux, choisir sa voie.",
    crit:"Respect strict du code de la route simulé et des autres usagers.",
    mat:"Carrefour tracé au sol, panneaux (stop, cédez le passage, feux), plots", duree:"15 min" },

  { id:"s21", bloc:"b2", niv:3, comps:["b2-cr","b2-co","b2-gi"],
    titre:"Le giratoire (Rond-point)",
    obj:"Entrer dans le giratoire, circuler et signaler sa sortie.",
    desc:"Rond-point matérialisé au sol avec entrées/sorties. Entrer (céder le passage), se placer à droite, signaler la sortie.",
    crit:"'Cédez-le-passage' respecté, bras droit tendu pour indiquer la sortie.",
    mat:"Rond-point tracé au sol (D = 8 m), plots, espace 10×10 m", duree:"15 min" },

  // ── BLOC 3 — Voie publique ────────────────────────────────
  { id:"s30", bloc:"b3", niv:3, comps:["b3-eq","b3-cr"],
    titre:"Vérification avant sortie (\"Contrôle technique\")",
    obj:"Vérifier systématiquement son vélo avant de circuler sur voie publique.",
    desc:"Chaque élève contrôle son vélo sur checklist : pneus, freins, selle, lumières. En binôme — chacun contrôle celui de l'autre.",
    crit:"Checklist complète validée pour 100% des vélos.", mat:"Checklist imprimée, outils basiques", duree:"10 min" },

  { id:"s31", bloc:"b3", niv:3, comps:["b3-dr","b3-us"],
    titre:"Rouler en file sur voie publique",
    obj:"Maintenir une file indienne ordonnée en tenant sa droite.",
    desc:"Sortie sur voie publique sécurisée. Rouler en file, 1 m d'écart, à droite. Signal d'arrêt transmis de l'avant vers l'arrière.",
    crit:"File maintenue sur 500 m sans débordement ni collision.", mat:"Gilets jaunes, équipement vélo, parcours repéré", duree:"30 min" },

  { id:"s32", bloc:"b3", niv:3, comps:["b3-cr","b3-pan"],
    titre:"Intersections & priorités réelles",
    obj:"Appliquer les règles de priorité aux intersections sur voie publique.",
    desc:"Sortie incluant 2-3 intersections. Avant chaque intersection, arrêt ou ralentissement, regard à gauche et droite, application de la règle.",
    crit:"Zéro infraction lors du passage des intersections.", mat:"Parcours pré-repéré, gilets jaunes", duree:"25 min" },

  { id:"s33", bloc:"b3", niv:3, comps:["b3-gi"],
    titre:"Giratoire réel",
    obj:"Prendre sa place et circuler dans un vrai rond-point.",
    desc:"Traversée d'un giratoire peu fréquenté : insertion, cédez le passage, signal de sortie, évitement des voitures.",
    crit:"Traversée complète sans infraction ni arrêt d'urgence.", mat:"Parcours repéré, gilets, encadrants supplémentaires", duree:"20 min" },

  { id:"s34", bloc:"b3", niv:3, comps:["b3-es"],
    titre:"Emprunter piste / bande cyclable",
    obj:"Identifier et utiliser les aménagements cyclables disponibles.",
    desc:"Sortie avec tronçons variés : piste cyclable, bande cyclable, chaussée. Identifier chaque espace et s'y adapter.",
    crit:"Bon espace emprunté à chaque type de voie.", mat:"Parcours mixte pré-repéré, gilets", duree:"25 min" },
];

/* ════════════════════════════════════════════════════
   ÉTAT GLOBAL
   ════════════════════════════════════════════════════ */
let state = {
  ecole:"", classe:"", effectif:24, lieu:"", seanceNum:1, seanceTotal:10,
  groupes: [
    { bloc:"b1", niv:1, effectif:8,  compsAuto:[], compsManual:[], situations:[], bilanComps:{}, bilanObs:"" },
    { bloc:"b1", niv:2, effectif:8,  compsAuto:[], compsManual:[], situations:[], bilanComps:{}, bilanObs:"" },
    { bloc:"b2", niv:2, effectif:8,  compsAuto:[], compsManual:[], situations:[], bilanComps:{}, bilanObs:"" },
  ],
};

const GRP_COLORS = ["#d62b2b","#0055a4","#e07b00","#7b5ea7","#1a8a4a"];
const GRP_NAMES  = ["Groupe A","Groupe B","Groupe C","Groupe D","Groupe E"];

/* ════════════════════════════════════════════════════
   NAVIGATION
   ════════════════════════════════════════════════════ */
function goStep(n) {
  const ids = {1:"screen-1", 2:"screen-2", 3:"screen-fiche", 4:"screen-suivi", 5:"screen-questionnaire"};
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.step-btn').forEach(b => { b.classList.remove('active','done'); });
  document.getElementById(ids[n]).classList.add('active');
  document.getElementById(`sbtn-${n}`).classList.add('active');
  for(let i=1;i<n;i++) document.getElementById(`sbtn-${i}`).classList.add('done');
  if(n >= 2) readStep1();
  if(n === 2) renderStep2();
  if(n === 4) renderSuivi();
  if(n === 5) renderQuestionnaire();
  window.scrollTo(0,0);
}

/* ════════════════════════════════════════════════════
   STEP 1
   ════════════════════════════════════════════════════ */
function renderGroupes() {
  const c = document.getElementById('groupes-list');
  if(state.groupes.length === 0) {
    c.innerHTML = `<div class="empty"><div class="empty-icon">👥</div><div class="empty-text">Aucun groupe — cliquez sur "+ Ajouter"</div></div>`;
    updateEffectifCheck(); return;
  }
  c.innerHTML = state.groupes.map((g,i) => {
    const isB3 = g.bloc === 'b3';
    return `
    <div class="grp-row" id="grp-row-${i}">
      <div class="grp-label">
        <span class="grp-dot" style="background:${GRP_COLORS[i%5]}"></span>
        ${GRP_NAMES[i]}
      </div>
      <div style="display:flex;gap:6px;flex-wrap:wrap;align-items:center">
        <select onchange="updateGroupe(${i},'bloc',this.value)" style="flex:1;min-width:160px">
          ${Object.entries(BLOCS_META).map(([k,v])=>`<option value="${k}" ${g.bloc===k?'selected':''}>${v.shortLabel} – ${v.label.split('–')[1].trim()}</option>`).join('')}
        </select>
        <select onchange="updateGroupe(${i},'niv',this.value)" style="flex:1;min-width:120px" ${isB3?'disabled':''}>
          <option value="1" ${g.niv===1?'selected':''}>Niveau 1</option>
          <option value="2" ${g.niv===2?'selected':''}>Niveau 2</option>
          <option value="3" ${g.niv===3?'selected':''}>Niveau 3</option>
        </select>
        ${isB3 ? `<span style="font-size:11px;color:var(--green);font-weight:700">🏫→🛣️ Classe entière</span>` : ''}
      </div>
      <div class="grp-effectif">
        <label class="label" style="text-align:center">Élèves</label>
        <input type="number" value="${g.effectif}" min="1" max="60"
          onchange="updateGroupe(${i},'effectif',+this.value)"
          style="text-align:center;width:100%" ${isB3?'disabled':''}>
      </div>
      <button class="btn-ghost" onclick="removeGroupe(${i})" title="Supprimer">✕</button>
    </div>`;
  }).join('');
  updateEffectifCheck();
}

function updateEffectifCheck() {
  const total = state.groupes.reduce((s,g) => s + (g.bloc==='b3' ? 0 : g.effectif), 0);
  const hasB3 = state.groupes.some(g => g.bloc==='b3');
  const eff = +document.getElementById('f-effectif').value || state.effectif;
  const el = document.getElementById('effectif-check');
  if(state.groupes.length === 0) { el.innerHTML=''; return; }
  if(hasB3) {
    el.innerHTML = `<span style="color:var(--green)">ℹ️ Bloc 3 : toute la classe participe ensemble (${eff} élèves)</span>`;
    return;
  }
  if(total === eff) {
    el.innerHTML = `<span style="color:var(--green)">✓ Répartition correcte : ${total} / ${eff} élèves</span>`;
  } else {
    el.innerHTML = `<span style="color:var(--red)">⚠ Répartition : ${total} élèves assignés pour ${eff} au total</span>`;
  }
}

function addGroupe() {
  if(state.groupes.length >= 5) return;
  state.groupes.push({ bloc:"b1", niv:1, effectif:6, compsAuto:[], compsManual:[], situations:[], bilanComps:{}, bilanObs:"" });
  renderGroupes(); autosave();
}
function removeGroupe(i) { state.groupes.splice(i,1); renderGroupes(); autosave(); }
function updateGroupe(i, field, val) {
  if(field === 'niv') {
    val = +val;
    state.groupes[i]._filterNiv = String(val); // filtre étape 2 suit le niveau
  }
  state.groupes[i][field] = val;
  // Si on passe en B3 : effectif = total classe
  if(field === 'bloc' && val === 'b3') {
    state.groupes[i].effectif = +document.getElementById('f-effectif').value || state.effectif;
    state.groupes[i].niv = 3;
    if(state.groupes.length > 1) {
      if(confirm('En Bloc 3, toute la classe participe ensemble. Supprimer les autres groupes ?')) {
        state.groupes = [state.groupes[i]];
      }
    }
  }
  renderGroupes(); autosave();
}
function readStep1() {
  state.ecole = document.getElementById('f-ecole').value;
  state.classe = document.getElementById('f-classe').value;
  state.effectif = +document.getElementById('f-effectif').value;
  state.lieu = document.getElementById('f-lieu').value;
  state.seanceNum = +document.getElementById('f-seance-num').value;
  state.seanceTotal = +document.getElementById('f-seance-total').value;
}

/* ════════════════════════════════════════════════════
   STEP 2 — SITUATIONS PAR GROUPE
   ════════════════════════════════════════════════════ */
function renderStep2() {
  const c = document.getElementById('groupes-sit-sections');
  c.innerHTML = state.groupes.map((g,i) => renderGroupeSection(g,i)).join('');
}

function renderGroupeSection(g, i) {
  const meta = BLOCS_META[g.bloc] || BLOCS_META.b1;
  const blocComps = (COMPETENCES[g.bloc]||{comps:[]}).comps;
  const color = GRP_COLORS[i%5];
  const isB3 = g.bloc === 'b3';

  // filtres actifs pour ce groupe
  const filterBloc = g._filterBloc || g.bloc;
  const filterNiv = g._filterNiv !== undefined ? g._filterNiv : String(g.niv);

  // situations filtrées
  let sits = SITUATIONS;
  sits = sits.filter(s => s.bloc === filterBloc);
  if(filterNiv !== 'all') sits = sits.filter(s => s.niv === +filterNiv);

  const allBlocs = Object.keys(BLOCS_META);

  return `
  <div class="grp-section" id="grp-sec-${i}">
    <div class="grp-section-head" style="background:${meta.bg}">
      <div class="grp-num" style="background:${color}">${i+1}</div>
      <div class="info">
        <div class="gsh-title">${GRP_NAMES[i]} · ${isB3 ? state.effectif : g.effectif} élèves</div>
        <div class="gsh-sub">${meta.label} · ${meta.contexte}</div>
      </div>
      <span class="bloc-tag b${g.bloc.slice(1)}">${meta.icon} ${meta.shortLabel}</span>
    </div>
    <div class="grp-section-body">
      ${isB3 ? `<div class="bloc3-notice">
        <strong>🛣️ Bloc 3 — Toute la classe sort ensemble</strong>
        En Bloc 3, aucun sous-groupe n'est séparé à l'école. La différenciation s'opère via les rôles (cycliste, observateur, signaleur) ou les positions dans la file. Les critères d'évaluation sont communs à tous les élèves.
      </div>` : ''}

      <!-- Compétences visées -->
      <div class="comp-section">
        <div class="comp-title">Compétences du livret visées pour cette séance</div>
        <div style="font-size:11px;color:#7a8a99;margin-bottom:8px;font-style:italic">
          Les compétences <span style="display:inline-flex;align-items:center;gap:3px;background:#e8f0fb;border:1.5px solid var(--blue);border-radius:10px;padding:1px 7px;font-size:10px;color:var(--blue);font-weight:700;font-style:normal">auto ✦</span> sont déduites automatiquement des situations choisies. Cliquez pour confirmer ou ajouter.
        </div>
        <div class="comp-pills">
          ${blocComps.map(comp => {
            const isAuto   = (g.compsAuto||[]).includes(comp.id);
            const isManual = (g.compsManual||[]).includes(comp.id);
            let cls = '', badge = '';
            if(isAuto && isManual) {
              cls = 'sel-both';
              badge = `<span class="comp-pill-badge badge-auto">✦ auto</span><span class="comp-pill-badge badge-manual">+ vous</span>`;
            } else if(isAuto) {
              cls = 'sel-auto';
              badge = `<span class="comp-pill-badge badge-auto-blue">✦ auto</span>`;
            } else if(isManual) {
              cls = 'sel-manual';
              badge = `<span class="comp-pill-badge badge-manual" style="background:rgba(255,255,255,.25);color:white">+ vous</span>`;
            }
            return `<div class="comp-pill ${cls}" onclick="toggleComp(${i},'${comp.id}')" title="${comp.detail} (N${comp.niv})">
              ${comp.label}
              <span class="comp-pill-niv">N${comp.niv}</span>
              ${badge}
            </div>`;
          }).join('')}
        </div>
      </div>

      <!-- Filtres situations -->
      <div class="filters-bar">
        <div class="filter-group">
          <div class="filter-label">📂 Filtrer par bloc</div>
          <div class="bloc-selector">
            ${allBlocs.map(bk => {
              const bm = BLOCS_META[bk];
              return `<div class="bloc-pill b${bk.slice(1)} ${filterBloc===bk?'sel':''}" onclick="setFilter(${i},'bloc','${bk}')">
                <span class="bloc-dot" style="background:${bm.color}"></span>${bm.shortLabel}
              </div>`;
            }).join('')}
          </div>
        </div>
        <div class="filter-group">
          <div class="filter-label">📊 Filtrer par niveau</div>
          <div class="niv-selector">
            <div class="niv-pill ${filterNiv==='all'?'sel':''}" onclick="setFilter(${i},'niv','all')">Tous</div>
            <div class="niv-pill ${filterNiv==='1'?'sel':''}" onclick="setFilter(${i},'niv','1')">Niveau 1</div>
            <div class="niv-pill ${filterNiv==='2'?'sel':''}" onclick="setFilter(${i},'niv','2')">Niveau 2</div>
            <div class="niv-pill ${filterNiv==='3'?'sel':''}" onclick="setFilter(${i},'niv','3')">Niveau 3</div>
          </div>
        </div>
      </div>

      <!-- Situations -->
      <div class="comp-section">
        <div class="comp-title">Situations (sélectionnez 2 à 4) — ${sits.length} disponibles</div>
        ${sits.length === 0
          ? `<div class="alert alert-warn">⚠ Aucune situation pour ces filtres. Modifiez le filtre Bloc ou Niveau.</div>`
          : `<div class="sit-grid">${sits.map(s => renderSitCard(s,i)).join('')}</div>`}
      </div>

      <!-- Bilan d'évaluation -->
      <div class="bilan-section">
        <div class="bilan-title">📊 Bilan d'évaluation — À renseigner après la séance</div>
        <div class="bilan-grid">
          ${effectiveComps(g).length === 0
            ? `<div style="font-size:12px;color:#aab;font-style:italic">Sélectionnez des situations ou des compétences ci-dessus pour activer le bilan.</div>`
            : effectiveComps(g).map(cid => {
                const cLabel = getCompLabel(cid);
                const val = (g.bilanComps||{})[cid] || '';
                return `<div class="bilan-row">
                  <div class="bilan-comp-name">${cLabel}</div>
                  <div class="bilan-btns">
                    <button class="bilan-btn ${val==='ok'?'sel-ok':''}" onclick="setBilan(${i},'${cid}','ok')">✓ Acquis</button>
                    <button class="bilan-btn ${val==='prog'?'sel-prog':''}" onclick="setBilan(${i},'${cid}','prog')">⟳ En cours</button>
                    <button class="bilan-btn ${val==='non'?'sel-non':''}" onclick="setBilan(${i},'${cid}','non')">✗ Non atteint</button>
                  </div>
                </div>`;
              }).join('')}
        </div>
        <div class="bilan-obs">
          <div class="label">Observations libres de l'enseignant</div>
          <textarea placeholder="Ex : Groupe A maîtrise bien le freinage, difficultés sur le slalom. 3 élèves ont encore besoin de travailler l'équilibre en virage…" onchange="setBilanObs(${i},this.value)">${g.bilanObs||''}</textarea>
        </div>
      </div>

    </div>
  </div>`;
}

function renderSitCard(s, gi) {
  const sel = (state.groupes[gi].situations||[]).includes(s.id);
  const meta = BLOCS_META[s.bloc];
  const spiralInfo = detectSpiral(s);
  return `
  <div class="sit-card ${sel?'selected':''}" id="sit-${gi}-${s.id}" onclick="toggleSit(${gi},'${s.id}')">
    <div class="sit-card-top">
      <div class="sit-check">${sel?'✓':''}</div>
      <div style="flex:1">
        <div class="sit-title">
          ${s.titre}
          <button class="sit-info-btn" onclick="event.stopPropagation();openSitModal('${s.id}')" title="Voir le détail">ℹ</button>
        </div>
        <div class="sit-comp">${s.comps.map(c => getCompLabel(c)).join(' · ')}</div>
        <div class="sit-badges">
          <span class="bloc-tag b${s.bloc.slice(1)}" style="font-size:9px">${meta.icon} ${meta.shortLabel}</span>
          <span class="sit-niv-badge niv-${s.niv}">Niveau ${s.niv}</span>
          ${spiralInfo ? `<span class="sit-spiral">↩︎ Spiral ${spiralInfo}</span>` : ''}
        </div>
      </div>
      <span style="font-size:11px;color:#8a9aaa;font-weight:700;white-space:nowrap">${s.duree}</span>
    </div>
  </div>`;
}

function detectSpiral(sit) {
  // Vérifie si une compétence de cette situation réapparaît dans d'autres blocs
  for(const cid of sit.comps) {
    for(const [bk, bd] of Object.entries(COMPETENCES)) {
      const comp = bd.comps.find(c => c.id === cid);
      if(comp && comp.spiral && comp.spiral.length > 0) {
        return comp.spiral.map(b => BLOCS_META[b]?.shortLabel || b).join('/');
      }
    }
  }
  return null;
}

function getCompLabel(id) {
  for(const bloc of Object.values(COMPETENCES)) {
    const c = bloc.comps.find(c => c.id === id);
    if(c) return c.label;
  }
  return id;
}

function setFilter(gi, type, val) {
  if(type === 'bloc') state.groupes[gi]._filterBloc = val;
  if(type === 'niv')  state.groupes[gi]._filterNiv  = val; // 'all', '1', '2' ou '3'
  const sec = document.getElementById(`grp-sec-${gi}`);
  if(sec) sec.outerHTML = renderGroupeSection(state.groupes[gi], gi);
}

/* ── helpers ── */
function effectiveComps(g) {
  // Union de compsAuto et compsManual, sans doublons
  const all = new Set([...(g.compsAuto||[]), ...(g.compsManual||[])]);
  return [...all];
}

function syncCompsAuto(gi) {
  // Recalcule les compétences automatiques à partir des situations sélectionnées
  const g = state.groupes[gi];
  const auto = new Set();
  (g.situations||[]).forEach(sid => {
    const s = SITUATIONS.find(x => x.id === sid);
    if(s) s.comps.forEach(cid => auto.add(cid));
  });
  g.compsAuto = [...auto];
}

function toggleComp(gi, cid) {
  const g = state.groupes[gi];
  if(!g.compsManual) g.compsManual = [];
  const isAuto   = (g.compsAuto||[]).includes(cid);
  const isManual = g.compsManual.includes(cid);

  if(isAuto && !isManual) {
    // Auto seule → on confirme manuellement (sel-both)
    g.compsManual.push(cid);
  } else if(isAuto && isManual) {
    // Les deux → on retire la confirmation manuelle (retour à sel-auto)
    g.compsManual = g.compsManual.filter(c => c !== cid);
  } else if(!isAuto && isManual) {
    // Manuel seul → on retire
    g.compsManual = g.compsManual.filter(c => c !== cid);
  } else {
    // Aucune → ajout manuel
    g.compsManual.push(cid);
  }
  const sec = document.getElementById(`grp-sec-${gi}`);
  if(sec) sec.outerHTML = renderGroupeSection(g, gi);
  autosave();
}

function toggleSit(gi, sid) {
  const g = state.groupes[gi];
  if(!g.situations) g.situations = [];
  const idx = g.situations.indexOf(sid);
  if(idx >= 0) {
    g.situations.splice(idx, 1);
  } else {
    if(g.situations.length >= 4) { alert('Maximum 4 situations par groupe.'); return; }
    g.situations.push(sid);
  }
  syncCompsAuto(gi);
  const sec = document.getElementById(`grp-sec-${gi}`);
  if(sec) sec.outerHTML = renderGroupeSection(g, gi);
  autosave();
}

function setBilan(gi, cid, val) {
  const g = state.groupes[gi];
  if(!g.bilanComps) g.bilanComps = {};
  g.bilanComps[cid] = g.bilanComps[cid] === val ? '' : val;
  const sec = document.getElementById(`grp-sec-${gi}`);
  if(sec) sec.outerHTML = renderGroupeSection(g, gi);
  autosave();
}

function setBilanObs(gi, val) {
  state.groupes[gi].bilanObs = val;
  autosave();
}

/* ════════════════════════════════════════════════════
   STEP 3 — FICHE DE SÉANCE
   ════════════════════════════════════════════════════ */
function generateFiche() {
  readStep1();
  goStep(3);
  const out = document.getElementById('fiche-output');
  const nbGroupes = state.groupes.length;
  const colW = `repeat(${Math.min(nbGroupes,3)}, 1fr)`;

  const allMat = new Set();
  state.groupes.forEach(g => {
    (g.situations||[]).forEach(sid => {
      const s = SITUATIONS.find(x=>x.id===sid);
      if(s) s.mat.split(',').forEach(m => allMat.add(m.trim()));
    });
  });

  const date = new Date().toLocaleDateString('fr-FR',{day:'numeric',month:'long',year:'numeric'});

  out.innerHTML = `
  <div class="fiche-banner">
    <div>
      <div class="fiche-title">Fiche de Séance<br><span>Savoir Rouler à Vélo</span></div>
      <div class="fiche-subtitle">Séance ${state.seanceNum} / ${state.seanceTotal} · Générée le ${date}</div>
      <div class="fiche-chips">
        ${state.ecole ? `<div class="fiche-chip">🏫 ${state.ecole}</div>` : ''}
        ${state.classe ? `<div class="fiche-chip">👨‍🏫 ${state.classe}</div>` : ''}
        ${state.lieu ? `<div class="fiche-chip">📍 ${state.lieu}</div>` : ''}
        <div class="fiche-chip">👥 ${state.effectif} élèves · ${nbGroupes} groupe${nbGroupes>1?'s':''}</div>
      </div>
    </div>
    <div style="text-align:right">
      <div style="font-family:'Barlow Condensed',sans-serif;font-weight:900;font-size:52px;color:rgba(255,255,255,.15);line-height:1">${state.seanceNum}</div>
      <div style="font-size:11px;color:rgba(255,255,255,.4);margin-top:-4px">SÉANCE</div>
    </div>
  </div>

  <div class="fiche-infos" style="grid-template-columns:repeat(${Math.min(nbGroupes,4)},1fr)">
    ${state.groupes.map((g,i) => {
      const meta = BLOCS_META[g.bloc]||BLOCS_META.b1;
      return `<div class="fi-cell">
        <div class="fi-lbl" style="color:${GRP_COLORS[i%5]}">${GRP_NAMES[i]}</div>
        <div class="fi-val">${g.bloc==='b3'?state.effectif:g.effectif} élèves</div>
        <div style="margin-top:5px">
          <span class="bloc-tag b${g.bloc.slice(1)}" style="font-size:9px">${meta.icon} ${meta.shortLabel}</span>
          ${g.bloc!=='b3' ? `<span class="bloc-tag" style="background:#f3f3f3;color:#555;font-size:9px;margin-left:3px">N${g.niv}</span>` : ''}
        </div>
      </div>`;
    }).join('')}
  </div>

  <div class="fiche-cols" style="grid-template-columns:${colW}">
    ${state.groupes.map((g,i) => {
      const meta = BLOCS_META[g.bloc]||BLOCS_META.b1;
      const color = GRP_COLORS[i%5];
      const compsViseesLabels = effectiveComps(g).map(c => getCompLabel(c));
      const sitsData = (g.situations||[]).map(sid => SITUATIONS.find(s=>s.id===sid)).filter(Boolean);
      return `
      <div class="fiche-col">
        <div class="fiche-col-head" style="background:${meta.bg}">
          <span class="fcol-dot" style="background:${color}"></span>
          <div>
            <div class="fcol-title">${GRP_NAMES[i]} <span style="font-weight:400;font-size:12px">· ${g.bloc==='b3'?state.effectif:g.effectif} élèves</span></div>
            <div class="fcol-sub">${meta.label} ${g.bloc!=='b3'?`· Niveau ${g.niv}`:''}</div>
          </div>
        </div>
        <div class="fcol-comp">
          ${compsViseesLabels.length > 0
            ? `<span style="font-weight:700;color:#1a3a5a">Compétences visées :</span> ${compsViseesLabels.join(' · ')}`
            : `<span style="color:#aab">Aucune compétence sélectionnée</span>`}
        </div>
        ${sitsData.length === 0
          ? `<div class="fiche-sit"><span style="color:#aab;font-size:12px;font-style:italic">Aucune situation sélectionnée</span></div>`
          : sitsData.map((s,si) => `
            <div class="fiche-sit">
              <span class="fiche-sit-num" style="background:${color}">${si+1}</span>
              <span class="fiche-sit-name">${s.titre}</span>
              <div class="fiche-sit-obj">🎯 ${s.obj}</div>
              <div class="fiche-sit-crit">✓ ${s.crit}</div>
              <div class="fiche-sit-mat">📦 ${s.mat} · <em>${s.duree}</em></div>
            </div>`).join('')}
      </div>`;
    }).join('')}
  </div>

  ${allMat.size > 0 ? `
  <div class="fiche-mat-bar">
    <div class="mat-title">📦 Matériel total à préparer</div>
    ${[...allMat].map(m=>`<span class="mat-chip">${m}</span>`).join('')}
  </div>` : ''}

  <!-- BILAN PAR GROUPE -->
  <div class="fiche-bilan-section">
    <div class="fiche-bilan-title">📊 Bilan d'évaluation — Par groupe</div>
    <div class="fiche-bilan-cols" style="grid-template-columns:repeat(${Math.min(nbGroupes,3)},1fr)">
      ${state.groupes.map((g,i) => {
        const meta = BLOCS_META[g.bloc]||BLOCS_META.b1;
        const color = GRP_COLORS[i%5];
        const compsLabels = effectiveComps(g).map(cid => ({ id:cid, label:getCompLabel(cid), val:(g.bilanComps||{})[cid]||'' }));
        return `
        <div class="fiche-bilan-grp">
          <div class="fiche-bilan-grp-head" style="background:${meta.bg}">
            <span class="fcol-dot" style="background:${color}"></span>
            <span class="fiche-bilan-grp-name">${GRP_NAMES[i]}</span>
            <span class="bloc-tag b${g.bloc.slice(1)}" style="margin-left:auto;font-size:9px">${meta.shortLabel}</span>
          </div>
          <div class="fiche-bilan-grp-body">
            ${compsLabels.length === 0
              ? `<div style="font-size:11px;color:#aab;font-style:italic;padding:6px 0">Aucune compétence sélectionnée</div>`
              : compsLabels.map(c => `
                <div class="fiche-bilan-comp-row">
                  <span>${c.label}</span>
                  <div class="fiche-bilan-scale">
                    <span class="fbs-item ${c.val==='ok'?'fbs-ok':''}">✓ Acquis</span>
                    <span class="fbs-item ${c.val==='prog'?'fbs-prog':''}">⟳ En cours</span>
                    <span class="fbs-item ${c.val==='non'?'fbs-non':''}">✗ Non atteint</span>
                  </div>
                </div>`).join('')}
            <div class="fiche-bilan-obs">
              <div class="fiche-bilan-obs-label">Observations</div>
              <div class="fiche-bilan-obs-box">${g.bilanObs ? g.bilanObs : 'À compléter après la séance…'}</div>
            </div>
          </div>
        </div>`;
      }).join('')}
    </div>
  </div>`;
}

/* ════════════════════════════════════════════════════
   CORRESPONDANCE QUESTIONNAIRE ÉLÈVE ↔ COMPÉTENCES
   Source : Annexe 3, questionnaire officiel SRAV
   ════════════════════════════════════════════════════ */
const QST_FAMILLES = [
  {
    id:"qf1", label:"Équipement & sécurité", color:"#7b5ea7",
    items:[
      { id:"q1a", label:"Mettre mon casque et vérifier les éléments de sécurité (freins, pneus…)", comps:["b0-eq","b1-eq","b2-eq","b3-eq"] },
    ]
  },
  {
    id:"qf2", label:"Maîtriser mon équilibre", color:"#d62b2b",
    items:[
      { id:"q2a", label:"Rouler en levant les pieds (glisser sur la draisienne)", comps:["b0-mv","b0-tr"] },
      { id:"q2b", label:"Rouler en libérant des appuis (pieds ou mains) sur vélo", comps:["b0-mv","b1-ap"] },
      { id:"q2c", label:"Sauter un obstacle (monter, descendre d'une planche)", comps:["b0-fr","b1-vi"] },
    ]
  },
  {
    id:"qf3", label:"Maîtriser ma trajectoire", color:"#d62b2b",
    items:[
      { id:"q3a", label:"Rouler en ligne droite", comps:["b1-ld"] },
      { id:"q3b", label:"Réaliser un enchaînement de virages", comps:["b1-ld","b1-ci"] },
      { id:"q3c", label:"Réaliser une trajectoire montante (rouler en danseuse)", comps:["b1-vt"] },
      { id:"q3d", label:"Réaliser une trajectoire descendante (freiner avec la roue arrière)", comps:["b1-fr"] },
    ]
  },
  {
    id:"qf4", label:"Maîtriser ma vitesse", color:"#e07b00",
    items:[
      { id:"q4a", label:"Accélérer, pédaler avec plus de force", comps:["b1-vt"] },
      { id:"q4b", label:"Freiner ou pédaler avec moins de force", comps:["b1-fr"] },
      { id:"q4c", label:"Entretenir une vitesse constante", comps:["b1-vt"] },
      { id:"q4d", label:"Utiliser le dérailleur en fonction du terrain", comps:["b1-vt"] },
    ]
  },
  {
    id:"qf5", label:"Gérer une distance", color:"#e07b00",
    items:[
      { id:"q5a", label:"Rouler en file indienne et gérer ma distance à l'autre", comps:["b2-au","b3-dr"] },
      { id:"q5b", label:"Rouler à 2 côte à côte", comps:["b2-au"] },
      { id:"q5c", label:"Rouler en groupe", comps:["b2-au","b3-dr"] },
      { id:"q5d", label:"M'arrêter au signal sans entrer en collision avec le vélo devant moi", comps:["b1-fr","b2-au"] },
    ]
  },
  {
    id:"qf6", label:"Gérer un parcours / sortie sur route", color:"#1a8a4a",
    items:[
      { id:"q6a", label:"Respecter les règles du code de la route", comps:["b2-cr","b3-cr","b1-pan","b2-pan","b3-pan"] },
      { id:"q6b", label:"Avertir d'un dépassement ou d'un changement de direction", comps:["b2-co","b3-us"] },
      { id:"q6c", label:"Prévenir d'un obstacle particulier", comps:["b2-co"] },
      { id:"q6d", label:"Appliquer les règles de traversée de route ou de carrefour", comps:["b2-gi","b3-gi","b3-cr"] },
      { id:"q6e", label:"Emprunter la bonne voie (piste cyclable, bande, chaussée)", comps:["b2-es","b3-es"] },
    ]
  },
  {
    id:"qf7", label:"En cas d'accident", color:"#1c2b3a",
    items:[
      { id:"q7a", label:"Prévenir les autres sans prendre de risque", comps:[] },
      { id:"q7b", label:"Appeler le numéro d'urgence adapté et donner un message d'alerte", comps:[] },
    ]
  },
];

/* ════════════════════════════════════════════════════
   CYCLE — ÉTAT PERSISTANT
   ════════════════════════════════════════════════════ */
let cycle = { ecole:"", classe:"", seances:[] };

function cycleCompsWorked() {
  const s = new Set();
  cycle.seances.forEach(sn => sn.groupes.forEach(g => {
    [...(g.compsAuto||[]), ...(g.compsManual||[])].forEach(c => s.add(c));
  }));
  return s;
}

/* ════════════════════════════════════════════════════
   SAUVEGARDE / EXPORT / IMPORT
   ════════════════════════════════════════════════════ */
function sauvegarderSeance() {
  readStep1();
  // Lire les bilans rapides depuis l'UI de l'étape 4
  syncBilanRapide();
  const snap = {
    num: state.seanceNum,
    total: state.seanceTotal,
    date: new Date().toLocaleDateString('fr-FR'),
    lieu: state.lieu,
    ecole: state.ecole,
    classe: state.classe,
    effectif: state.effectif,
    groupes: JSON.parse(JSON.stringify(state.groupes))
  };
  const idx = cycle.seances.findIndex(s => s.num === snap.num);
  if(idx >= 0) cycle.seances[idx] = snap;
  else cycle.seances.push(snap);
  cycle.seances.sort((a,b) => a.num - b.num);
  cycle.ecole = state.ecole;
  cycle.classe = state.classe;
  return snap;
}

function exporterCycle() {
  sauvegarderSeance();
  const nom = `SRAV-${(cycle.classe||'Classe').replace(/[\s\/\\]/g,'-')}-cycle.json`;
  const blob = new Blob([JSON.stringify(cycle, null, 2)], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = nom;
  document.body.appendChild(a);
  a.click();
  setTimeout(() => { document.body.removeChild(a); URL.revokeObjectURL(url); }, 500);
  showToast(`💾 Cycle sauvegardé : ${nom}`);
  renderSuivi();
}

function importCycle(input) {
  const file = input.files && input.files[0];
  if(!file) return;
  _readCycleFile(file);
  input.value = '';
}

function handleDrop(e) {
  e.preventDefault();
  document.getElementById('import-dropzone').classList.remove('drag');
  const file = e.dataTransfer.files && e.dataTransfer.files[0];
  if(!file || !file.name.endsWith('.json')) {
    showToast('⚠ Déposez un fichier .json valide');
    return;
  }
  _readCycleFile(file);
}

function _readCycleFile(file) {
  const reader = new FileReader();
  reader.onload = e => {
    try {
      const data = JSON.parse(e.target.result);
      if(!Array.isArray(data.seances)) throw new Error('Format invalide');
      cycle = data;
      // Restaurer depuis la dernière séance sauvegardée
      const last = cycle.seances[cycle.seances.length - 1];
      if(last) {
        state.seanceNum   = (last.num || 0) + 1;
        state.seanceTotal = last.total || state.seanceTotal;
        state.lieu        = last.lieu  || '';
        state.effectif    = last.effectif || state.effectif;
        state.ecole       = last.ecole || cycle.ecole || '';
        state.classe      = last.classe || cycle.classe || '';
        // Copie des groupes de la dernière séance — bilans remis à zéro pour la nouvelle
        state.groupes = JSON.parse(JSON.stringify(last.groupes)).map(g => ({
          ...g,
          bilanComps: {},
          bilanObs:   '',
          situations: [],        // séance suivante = nouvelle sélection
          compsAuto:  [],
          _filterBloc: g.bloc,
          _filterNiv:  String(g.niv)
        }));
        // Sync champs étape 1
        const fields = {
          'f-ecole': state.ecole, 'f-classe': state.classe,
          'f-effectif': state.effectif, 'f-lieu': state.lieu,
          'f-seance-num': state.seanceNum, 'f-seance-total': state.seanceTotal
        };
        Object.entries(fields).forEach(([id,val]) => {
          const el = document.getElementById(id);
          if(el) el.value = val;
        });
        renderGroupes();
      }
      renderSuivi();
      showToast(`✓ ${cycle.seances.length} séance(s) chargée(s) — prêt pour la séance ${state.seanceNum}`);
      autosave();
    } catch(err) {
      showToast('⚠ Fichier invalide — utilisez un fichier .json exporté par cet outil');
    }
  };
  reader.readAsText(file);
}

/* ────── Bilan rapide (dans l'écran Suivi) ────── */
function renderBilanRapide() {
  const c = document.getElementById('bilan-rapide-list');
  if(!c) return;
  if(state.groupes.length === 0) {
    c.innerHTML = `<div style="padding:16px;font-size:13px;color:#aab;font-style:italic">Aucun groupe configuré. Commencez par l'étape 1.</div>`;
    return;
  }
  c.innerHTML = state.groupes.map((g,i) => {
    const meta  = BLOCS_META[g.bloc] || BLOCS_META.b1;
    const color = GRP_COLORS[i%5];
    const comps = effectiveComps(g);
    return `
    <div style="border-bottom:1px solid var(--line);padding:14px 18px" id="br-grp-${i}">
      <div style="display:flex;align-items:center;gap:8px;margin-bottom:10px">
        <span style="width:10px;height:10px;border-radius:50%;background:${color};display:inline-block"></span>
        <span style="font-family:'Barlow Condensed',sans-serif;font-weight:700;font-size:15px">${GRP_NAMES[i]}</span>
        <span class="bloc-tag b${g.bloc.slice(1)}" style="font-size:9px">${meta.shortLabel}</span>
        <span style="font-size:11px;color:#7a8a99;margin-left:4px">${g.bloc==='b3'?state.effectif:g.effectif} élèves</span>
      </div>
      ${comps.length === 0
        ? `<div style="font-size:12px;color:#aab;font-style:italic">Aucune compétence — sélectionnez des situations en étape 2 d'abord.</div>`
        : `<div style="display:flex;flex-direction:column;gap:6px;margin-bottom:10px">
            ${comps.map(cid => {
              const val = (g.bilanComps||{})[cid] || '';
              return `<div style="display:grid;grid-template-columns:1fr auto;gap:10px;align-items:center;background:var(--mist);border-radius:6px;padding:6px 10px">
                <span style="font-size:12px;font-weight:700;color:var(--slate)">${getCompLabel(cid)}</span>
                <div style="display:flex;gap:4px">
                  <button class="bilan-btn ${val==='ok'?'sel-ok':''}" onclick="setBilanSuivi(${i},'${cid}','ok')">✓ Acquis</button>
                  <button class="bilan-btn ${val==='prog'?'sel-prog':''}" onclick="setBilanSuivi(${i},'${cid}','prog')">⟳ En cours</button>
                  <button class="bilan-btn ${val==='non'?'sel-non':''}" onclick="setBilanSuivi(${i},'${cid}','non')">✗ Non atteint</button>
                </div>
              </div>`;
            }).join('')}
          </div>
          <div>
            <label class="label">Observations (élèves à surveiller, points clés…)</label>
            <textarea rows="2" placeholder="Ex : Lucas — freinage encore trop tardif. Emma prête pour passer au niveau 2…" 
              onchange="setBilanObsSuivi(${i},this.value)"
              style="font-size:13px">${g.bilanObs||''}</textarea>
          </div>`}
    </div>`;
  }).join('');
}

function setBilanSuivi(gi, cid, val) {
  const g = state.groupes[gi];
  if(!g.bilanComps) g.bilanComps = {};
  g.bilanComps[cid] = g.bilanComps[cid] === val ? '' : val;
  renderBilanRapide();
  autosave();
}

function setBilanObsSuivi(gi, val) {
  state.groupes[gi].bilanObs = val;
  autosave();
}

function syncBilanRapide() {
  // Les bilans sont déjà dans state.groupes via setBilanSuivi / setBilanObsSuivi
  // Les textareas : on relit pour ne pas perdre du texte non déclenché par onchange
  state.groupes.forEach((g,i) => {
    const wrap = document.getElementById(`br-grp-${i}`);
    if(!wrap) return;
    const ta = wrap.querySelector('textarea');
    if(ta) g.bilanObs = ta.value;
  });
}

/* ════════════════════════════════════════════════════
   RENDU SUIVI
   ════════════════════════════════════════════════════ */
function renderSuivi() {
  renderBilanRapide();
  const hasSeances = cycle.seances.length > 0;
  document.getElementById('cycle-count').textContent = hasSeances ? `${cycle.seances.length} séance(s) dans le cycle` : '';

  // ── Synthèse progression ──
  const wrap = document.getElementById('cycle-summary-wrap');
  if(!hasSeances) { wrap.innerHTML = ''; }
  else {
    const allComps = new Map();
    cycle.seances.forEach(sn => sn.groupes.forEach(g => {
      [...(g.compsAuto||[]), ...(g.compsManual||[])].forEach(cid => {
        if(!allComps.has(cid)) allComps.set(cid, getCompLabel(cid));
      });
    }));

    wrap.innerHTML = allComps.size === 0 ? '' : `
    <div class="cycle-summary card" style="margin-bottom:16px">
      <div class="cycle-summary-head card-head">
        <div class="card-head-icon" style="background:#e6f4ec">📈</div>
        <span class="card-title">Progression sur le cycle — ${cycle.seances.length} séance(s)</span>
        <span style="margin-left:auto;font-size:10px;color:#7a8a99;display:flex;gap:8px;align-items:center">
          <span><span class="cycle-dot ok" style="display:inline-flex;width:12px;height:12px;font-size:7px"> </span> Acquis</span>
          <span><span class="cycle-dot en" style="display:inline-flex;width:12px;height:12px;font-size:7px"> </span> En cours</span>
          <span><span class="cycle-dot non" style="display:inline-flex;width:12px;height:12px;font-size:7px"> </span> Non atteint</span>
          <span><span class="cycle-dot nd" style="display:inline-flex;width:12px;height:12px;font-size:7px"> </span> Travaillé</span>
        </span>
      </div>
      ${[...allComps.entries()].map(([cid, clabel]) => {
        const dots = cycle.seances.map(sn => {
          for(const g of sn.groupes) {
            if([...(g.compsAuto||[]),...(g.compsManual||[])].includes(cid)) {
              const val = (g.bilanComps||{})[cid] || 'nd';
              const titles = {ok:'Acquis',prog:'En cours',non:'Non atteint',nd:'Travaillé sans bilan'};
              return `<div class="cycle-dot ${val==='prog'?'en':val}" title="S${sn.num} · ${titles[val]||val}">${sn.num}</div>`;
            }
          }
          return '';
        }).filter(Boolean).join('');
        return `<div class="cycle-comp-row">
          <div class="cycle-comp-label">${clabel}</div>
          <div class="cycle-comp-dots">${dots||'<span style="font-size:11px;color:#aab;font-style:italic">non encore évalué</span>'}</div>
        </div>`;
      }).join('')}
    </div>`;
  }

  // ── Historique séances ──
  const list = document.getElementById('seance-history-list');
  if(!hasSeances) {
    list.innerHTML = `<div class="empty" style="padding:24px"><div class="empty-icon">📭</div><div class="empty-text">Aucune séance sauvegardée</div><p style="font-size:12px;color:#aab;margin-top:6px">Remplissez le bilan ci-dessus et cliquez "Sauvegarder &amp; exporter"</p></div>`;
    return;
  }
  list.innerHTML = cycle.seances.map((sn,idx) => {
    const groupsDesc = sn.groupes.map((g,gi) => `${GRP_NAMES[gi]} (${(BLOCS_META[g.bloc]||BLOCS_META.b1).shortLabel})`).join(', ');
    return `
    <div class="seance-card">
      <div class="seance-card-head" onclick="toggleSeanceCard(${idx})">
        <div class="seance-num">${sn.num}</div>
        <div class="seance-meta">
          <div class="seance-meta-title">Séance ${sn.num} / ${sn.total} · ${sn.date}</div>
          <div class="seance-meta-sub">${sn.lieu ? sn.lieu+' · ' : ''}${groupsDesc}</div>
        </div>
        <span class="seance-expand" id="seance-expand-${idx}">▼ Voir le bilan</span>
      </div>
      <div class="seance-card-body" id="seance-body-${idx}">
        ${sn.groupes.map((g,gi) => {
          const meta  = BLOCS_META[g.bloc]||BLOCS_META.b1;
          const comps = [...new Set([...(g.compsAuto||[]),...(g.compsManual||[])])];
          const valLabels = {ok:'✓ Acquis', prog:'⟳ En cours', non:'✗ Non atteint', nd:'— Sans bilan'};
          return comps.length === 0
            ? `<p style="font-size:12px;color:#aab;font-style:italic;margin-bottom:8px">${GRP_NAMES[gi]} — aucune compétence</p>`
            : `<div style="margin-bottom:14px">
                <div style="font-family:'Barlow Condensed',sans-serif;font-weight:700;font-size:14px;color:${meta.color};margin-bottom:6px">${GRP_NAMES[gi]} · ${meta.label}</div>
                <table class="prog-table">
                  <tr><th>Compétence</th><th>Résultat du groupe</th></tr>
                  ${comps.map(cid => {
                    const val = (g.bilanComps||{})[cid]||'nd';
                    return `<tr><td>${getCompLabel(cid)}</td><td><span class="prog-dot prog-${val==='prog'?'en':val}">${valLabels[val]||val}</span></td></tr>`;
                  }).join('')}
                </table>
                ${g.bilanObs ? `<div style="font-size:11px;color:#5a7090;margin-top:6px;padding:6px 10px;background:#f7f9fb;border-radius:4px;font-style:italic">💬 ${g.bilanObs}</div>` : ''}
              </div>`;
        }).join('')}
      </div>
    </div>`;
  }).join('');
}

function toggleSeanceCard(idx) {
  const body = document.getElementById(`seance-body-${idx}`);
  const exp  = document.getElementById(`seance-expand-${idx}`);
  const open = body.classList.toggle('open');
  exp.textContent = open ? '▲ Masquer' : '▼ Voir le bilan';
}

/* ════════════════════════════════════════════════════
   QUESTIONNAIRE ÉLÈVE
   ════════════════════════════════════════════════════ */
function renderQuestionnaire() {
  const worked = cycleCompsWorked();
  const hideUnused = document.getElementById('qst-hide-unused')?.checked;
  const date = new Date().toLocaleDateString('fr-FR',{day:'numeric',month:'long',year:'numeric'});

  const body = QST_FAMILLES.map(fam => {
    const items = fam.items.filter(it => {
      if(hideUnused && it.comps.length > 0 && !it.comps.some(c => worked.has(c))) return false;
      return true;
    });
    if(items.length === 0) return '';

    const rows = items.map(it => {
      const isWorked = it.comps.length === 0 || it.comps.some(c => worked.has(c));
      const dimStyle = (!isWorked) ? 'opacity:.35' : '';
      return `<div class="qst-item" style="${dimStyle}">
        <div class="qst-item-label">${!isWorked ? '○ ' : ''}${it.label}</div>
        <div class="qst-check-cell"><div class="qst-box"></div></div>
        <div class="qst-check-cell"><div class="qst-box"></div></div>
        <div class="qst-check-cell"><div class="qst-box"></div></div>
      </div>`;
    }).join('');

    return `<div class="qst-famille">
      <div class="qst-famille-head" style="background:${fam.color}">${fam.label}</div>
      <div class="qst-col-header">
        <div class="qst-col-label">Je suis capable de…</div>
        <div class="qst-col-label">OUI</div>
        <div class="qst-col-label">NON</div>
        <div class="qst-col-label">UN PEU</div>
      </div>
      ${rows}
    </div>`;
  }).join('');

  document.getElementById('qst-output').innerHTML = `
  <div class="qst-header">
    <div>
      <div class="qst-title">Auto-évaluation · Savoir Rouler à Vélo</div>
      <div class="qst-subtitle">${cycle.classe||'Classe'} · ${date}</div>
    </div>
    <div style="text-align:right">
      <div style="font-size:10px;color:rgba(255,255,255,.5);margin-bottom:4px">PRÉNOM</div>
      <input class="qst-prenom" placeholder="____________________" />
    </div>
  </div>
  ${body}`;
}

function printQuestionnaire() {
  renderQuestionnaire();
  // Ajouter la classe sur body pour activer les règles CSS print-qst
  document.body.classList.add('print-qst');
  window.print();
  // Retirer la classe après l'impression
  setTimeout(() => document.body.classList.remove('print-qst'), 500);
}

/* ════════════════════════════════════════════════════
   AUTOSAVE — localStorage
   Sauvegarde automatique à chaque action significative
   ════════════════════════════════════════════════════ */
const LS_KEY_STATE = 'srav_state_v5';
const LS_KEY_CYCLE = 'srav_cycle_v5';
let _autosaveTimer = null;

function autosave() {
  // Indiquer "en cours"
  const dot = document.getElementById('autosave-dot');
  const msg = document.getElementById('autosave-msg');
  const bar = document.getElementById('autosave-bar');
  if(dot) dot.classList.add('saving');
  if(bar) bar.classList.remove('hidden');

  clearTimeout(_autosaveTimer);
  _autosaveTimer = setTimeout(() => {
    try {
      // Lire les éventuels textes non encore déclenchés
      syncBilanRapide();
      readStep1();
      localStorage.setItem(LS_KEY_STATE, JSON.stringify(state));
      localStorage.setItem(LS_KEY_CYCLE, JSON.stringify(cycle));
      const now = new Date().toLocaleTimeString('fr-FR', {hour:'2-digit', minute:'2-digit'});
      if(dot) dot.classList.remove('saving');
      if(msg) msg.textContent = `Sauvegarde automatique — ${now}`;
    } catch(e) {
      // localStorage plein ou désactivé — on ignore silencieusement
      if(dot) dot.classList.remove('saving');
    }
  }, 800); // délai pour grouper les appels rapides
}

function restaurerSession() {
  try {
    const savedState = localStorage.getItem(LS_KEY_STATE);
    const savedCycle = localStorage.getItem(LS_KEY_CYCLE);
    if(savedState) {
      const s = JSON.parse(savedState);
      Object.assign(state, s);
      // Sync champs étape 1
      const fields = {
        'f-ecole': state.ecole, 'f-classe': state.classe,
        'f-effectif': state.effectif, 'f-lieu': state.lieu,
        'f-seance-num': state.seanceNum, 'f-seance-total': state.seanceTotal
      };
      Object.entries(fields).forEach(([id,val]) => {
        const el = document.getElementById(id);
        if(el) el.value = val;
      });
      renderGroupes();
    }
    if(savedCycle) {
      const c = JSON.parse(savedCycle);
      Object.assign(cycle, c);
    }
    document.getElementById('session-banner').style.display = 'none';
    showToast('✓ Session restaurée — reprise là où vous en étiez');
    autosave();
  } catch(e) {
    showToast('⚠ Impossible de restaurer la session');
  }
}

function ignorerSession() {
  document.getElementById('session-banner').style.display = 'none';
  localStorage.removeItem(LS_KEY_STATE);
  localStorage.removeItem(LS_KEY_CYCLE);
}

function verifierSessionExistante() {
  try {
    const saved = localStorage.getItem(LS_KEY_STATE);
    if(!saved) return;
    const s = JSON.parse(saved);
    // Il y a quelque chose de non-vide : montrer la bannière
    const hasData = s.ecole || s.classe || s.groupes?.some(g => g.situations?.length > 0);
    if(hasData) {
      document.getElementById('session-banner').style.display = 'flex';
    }
  } catch(e) { /* ignore */ }
}

/* ════════════════════════════════════════════════════
   PRÉPARER LA SÉANCE SUIVANTE
   Archive la séance courante, remet situations/bilans
   à zéro, incrémente le numéro de séance
   ════════════════════════════════════════════════════ */
function preparerSeanceSuivante() {
  // Vérifier qu'il y a quelque chose à archiver
  const hasContent = state.groupes.some(g =>
    (g.situations||[]).length > 0 || Object.keys(g.bilanComps||{}).length > 0
  );
  if(!hasContent && cycle.seances.length === 0) {
    showToast('⚠ Aucune séance à archiver — configurez d\'abord vos groupes et situations');
    return;
  }

  // Archiver la séance courante si elle a du contenu
  if(hasContent) sauvegarderSeance();

  // Remettre situations, bilans et compétences auto à zéro
  // mais conserver bloc, niv, effectif, compsManual
  state.groupes = state.groupes.map(g => ({
    ...g,
    situations:  [],
    compsAuto:   [],
    compsManual: [],
    bilanComps:  {},
    bilanObs:    '',
    _filterBloc: g.bloc,
    _filterNiv:  String(g.niv)
  }));

  // Incrémenter le numéro de séance
  state.seanceNum = (state.seanceNum || 1) + 1;
  const el = document.getElementById('f-seance-num');
  if(el) el.value = state.seanceNum;

  // Autosave du nouvel état propre
  autosave();

  // Mettre à jour l'affichage
  renderSuivi();
  renderGroupes();

  showToast(`✓ Séance ${state.seanceNum - 1} archivée — prêt pour la séance ${state.seanceNum}`);

  // Aller à l'étape 2 pour choisir les nouvelles situations
  setTimeout(() => goStep(2), 800);
}
function confirmerReinit() {
  const modal = document.getElementById('reinit-modal');
  modal.style.display = 'flex';
}
function fermerReinit() {
  document.getElementById('reinit-modal').style.display = 'none';
}
function reinitialiser() {
  // Vider localStorage
  localStorage.removeItem(LS_KEY_STATE);
  localStorage.removeItem(LS_KEY_CYCLE);
  // Remettre l'état à zéro
  state = {
    ecole:"", classe:"", effectif:24, lieu:"", seanceNum:1, seanceTotal:10,
    groupes: []
  };
  cycle = { ecole:"", classe:"", seances:[] };
  // Sync UI étape 1
  ['f-ecole','f-classe','f-lieu'].forEach(id => { const el=document.getElementById(id); if(el) el.value=''; });
  document.getElementById('f-effectif').value = 24;
  document.getElementById('f-seance-num').value = 1;
  document.getElementById('f-seance-total').value = 10;
  renderGroupes();
  // Cacher la bannière de session si visible
  const banner = document.getElementById('session-banner');
  if(banner) banner.style.display = 'none';
  // Cacher la barre autosave
  const bar = document.getElementById('autosave-bar');
  if(bar) bar.classList.add('hidden');
  // Fermer le modal et revenir à l'étape 1
  fermerReinit();
  goStep(1);
  showToast('🗑 Outil réinitialisé — nouvelle session prête');
}

// Fermer le modal en cliquant à l'extérieur
document.getElementById('reinit-modal').addEventListener('click', function(e) {
  if(e.target === this) fermerReinit();
});
/* ════════════════════════════════════════════════════
   MODAL DÉTAIL SITUATION
   ════════════════════════════════════════════════════ */
const NIV_LABELS_FULL = { 1:"Niveau 1 — Premier contact", 2:"Niveau 2 — Maîtrise intermédiaire", 3:"Niveau 3 — Maniabilité experte" };

function openSitModal(sid) {
  const s = SITUATIONS.find(x => x.id === sid);
  if(!s) return;
  const meta = BLOCS_META[s.bloc];
  const overlay = document.getElementById('sit-modal-overlay');

  // Header couleur bloc
  document.getElementById('sit-modal-header').style.background = meta.color;
  document.getElementById('sit-modal-titre').textContent = s.titre;

  // Badges
  document.getElementById('sit-modal-badges').innerHTML = `
    <span>${meta.icon} ${meta.label}</span>
    <span>${NIV_LABELS_FULL[s.niv] || 'Niveau '+s.niv}</span>
    <span>⏱ ${s.duree}</span>`;

  // Corps
  document.getElementById('sit-modal-body').innerHTML = `
    <div class="sit-modal-row">
      <div class="sit-modal-icon" style="background:#e8f0fe">🎯</div>
      <div class="sit-modal-row-content">
        <div class="sit-modal-row-label">Objectif</div>
        <div class="sit-modal-row-text">${s.obj}</div>
      </div>
    </div>
    <div class="sit-modal-row">
      <div class="sit-modal-icon" style="background:#f0f4f8">📐</div>
      <div class="sit-modal-row-content">
        <div class="sit-modal-row-label">Dispositif &amp; Action</div>
        <div class="sit-modal-row-text">${s.desc}</div>
      </div>
    </div>
    <div class="sit-modal-crit">
      ✅ <strong>Critère de réussite</strong><br>${s.crit}
    </div>
    ${s.note ? `<div class="sit-modal-note">💡 <strong>Conseil pédagogique</strong><br>${s.note}</div>` : ''}
    <div class="sit-modal-row">
      <div class="sit-modal-icon" style="background:#f3f3f3">🏷</div>
      <div class="sit-modal-row-content">
        <div class="sit-modal-row-label">Compétences travaillées</div>
        <div class="sit-modal-row-text">${s.comps.map(c => getCompLabel(c)).join(' · ')}</div>
      </div>
    </div>`;

  // Footer matériel
  document.getElementById('sit-modal-footer').innerHTML = `
    <div class="sit-modal-mat">📦 ${s.mat}</div>
    <button class="btn btn-primary btn-sm" onclick="document.getElementById('sit-modal-overlay').style.display='none'">Fermer</button>`;

  overlay.style.display = 'flex';
}

function closeSitModal(event) {
  if(event.target === document.getElementById('sit-modal-overlay')) {
    document.getElementById('sit-modal-overlay').style.display = 'none';
  }
}

document.addEventListener('keydown', e => {
  if(e.key === 'Escape') document.getElementById('sit-modal-overlay').style.display = 'none';
});

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2800);
}

/* ════════════════════════════════════════════════════
   INIT
   ════════════════════════════════════════════════════ */
renderGroupes();
document.getElementById('f-effectif').addEventListener('input', () => { updateEffectifCheck(); autosave(); });

// Autosave sur tous les champs étape 1
['f-ecole','f-classe','f-lieu','f-seance-num','f-seance-total'].forEach(id => {
  const el = document.getElementById(id);
  if(el) el.addEventListener('input', autosave);
});

// Drag-drop JSON sur l'écran suivi
document.addEventListener('dragover', e => e.preventDefault());
document.addEventListener('drop', e => {
  e.preventDefault();
  if(document.getElementById('screen-suivi').classList.contains('active')) {
    const file = e.dataTransfer.files && e.dataTransfer.files[0];
    if(file && file.name.endsWith('.json')) _readCycleFile(file);
  }
});

// Vérifier si une session précédente existe
verifierSessionExistante();
</script>
<!-- ══════════════════════════════════════════════
     GOATCOUNTER — Analytics RGPD-friendly
     Remplacez VOTRE-NOM par votre identifiant
     créé sur goatcounter.com
     ══════════════════════════════════════════════ -->
<script data-goatcounter="https://VOTRE-NOM.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
</body>
</html>
